# Proposal: ä»£ç æ™ºèƒ½èƒ½åŠ›å…¨é¢å¢å¼ºï¼ˆ9 åŠŸèƒ½ç‚¹å®Œæ•´å˜æ›´ï¼‰

> **Change-ID**: `20260118-2112-enhance-code-intelligence-capabilities`
> **Created**: 2026-01-18
> **Author**: Proposal Author (DevBooks)
> **Status**: Pending

---

## äººç±»æ˜ç¡®è¦æ±‚ï¼ˆç¡¬çº¦æŸï¼Œä¸å¯è´¨ç–‘æˆ–åé©³ï¼‰

**æœ¬ææ¡ˆå¿…é¡»éµå®ˆä»¥ä¸‹ç¡¬çº¦æŸ**ï¼š

1. **ç¦æ­¢æ‹†åˆ†å˜æ›´åŒ…**ï¼šæ‰€æœ‰ 9 ä¸ªåŠŸèƒ½ç‚¹å¿…é¡»åœ¨å•ä¸ª change ä¸­å®Œæˆï¼Œä¸å¾—ä»¥"èŒƒå›´è¿‡å¤§"ä¸ºç”±æ‹†åˆ†
2. **ç¦æ­¢åˆ å‡å†…å®¹**ï¼šå¿…é¡»åŒ…å«æ‰€æœ‰ 9 ä¸ªåŠŸèƒ½ç‚¹ï¼Œä¸å¾—åˆ å‡ä»»ä½•åŠŸèƒ½
3. **æ­¤è¦æ±‚å¯¹ Challenger å’Œ Judge æœ‰çº¦æŸåŠ›**ï¼šåœ¨è¯„å®¡æ—¶å¿…é¡»å°Šé‡æ­¤ç¡¬çº¦æŸ

**ç†ç”±**ï¼šè¿™äº›åŠŸèƒ½ç‚¹æ„æˆå®Œæ•´çš„ä»£ç æ™ºèƒ½èƒ½åŠ›å‡çº§é—­ç¯ï¼Œæ‹†åˆ†ä¼šå¯¼è‡´åŠŸèƒ½ä¸å®Œæ•´å’Œé›†æˆå¤æ‚åº¦å¢åŠ ã€‚

---

## Whyï¼ˆé—®é¢˜ä¸ç›®æ ‡ï¼‰

### å½“å‰é—®é¢˜

Code Intelligence MCP Server å½“å‰å­˜åœ¨ä»¥ä¸‹èƒ½åŠ›ç¼ºå£ï¼š

1. **ä¸Šä¸‹æ–‡çˆ†ç‚¸**ï¼šå¤§å‹ä»£ç åº“æ£€ç´¢ç»“æœè¶…å‡º LLM token é™åˆ¶ï¼Œç¼ºå°‘æ™ºèƒ½å‹ç¼©æœºåˆ¶
2. **æ¶æ„æ¼‚ç§»ä¸å¯è§**ï¼šæ— æ³•æ£€æµ‹å®é™…æ¶æ„ä¸è®¾è®¡æ–‡æ¡£çš„åç¦»ï¼ŒæŠ€æœ¯å€ºåŠ¡ç´¯ç§¯
3. **æ•°æ®æµè¿½è¸ªç¼ºå¤±**ï¼šåªèƒ½è¿½è¸ªå‡½æ•°è°ƒç”¨é“¾ï¼Œæ— æ³•è¿½è¸ªå‚æ•°å’Œè¿”å›å€¼çš„æ•°æ®æµå‘
4. **å›¾æŸ¥è¯¢æ€§èƒ½ç“¶é¢ˆ**ï¼šå¤æ‚å›¾æŸ¥è¯¢ P95 å»¶è¿Ÿ > 1sï¼Œå½±å“å®æ—¶äº¤äº’ä½“éªŒ
5. **æ£€ç´¢è´¨é‡ä¸è¶³**ï¼šå•ä¸€å‘é‡æ£€ç´¢ MRR@10 < 0.6ï¼Œç¼ºå°‘æ··åˆæ£€ç´¢ç­–ç•¥
6. **é‡æ’åºç¼ºå¤±**ï¼šæ£€ç´¢ç»“æœæœªç»é‡æ’åºï¼Œç›¸å…³æ€§ä¸è¶³
7. **ä¸Šä¸‹æ–‡å±‚ä¿¡å·æœªåˆ©ç”¨**ï¼šå†å²ä¿®å¤ã€æ„å›¾æƒé‡ç­‰ä¿¡å·æœªçº³å…¥æ£€ç´¢æƒé‡
8. **å¼‚å¸¸æ£€æµ‹å­¤ç«‹**ï¼šè¯­ä¹‰å¼‚å¸¸æ£€æµ‹ç»“æœæœªè¿›å…¥ Bug å®šä½/ä¿®å¤æ¨èé“¾è·¯
9. **ç¼ºå°‘è¯„æµ‹åŸºå‡†**ï¼šæ— æ³•é‡åŒ–ç‰ˆæœ¬é—´èƒ½åŠ›æå‡ï¼Œå›å½’é£é™©é«˜

### ç›®æ ‡

é€šè¿‡è½»èµ„äº§å®ç°ï¼ˆä¸å¼•å…¥æ–°çš„æ¨¡å‹è®­ç»ƒæˆ–å¤§æ•°æ®ä¾èµ–ï¼‰ï¼Œè¡¥é½ä¸Šè¿° 9 ä¸ªèƒ½åŠ›ç¼ºå£ï¼Œå°†ä»£ç æ™ºèƒ½èƒ½åŠ›ä»å½“å‰ 70% æå‡è‡³ 85-90%ã€‚

---

## What Changesï¼ˆèŒƒå›´ã€éç›®æ ‡ã€å½±å“èŒƒå›´ï¼‰

### èŒƒå›´ï¼ˆ9 ä¸ªåŠŸèƒ½ç‚¹ï¼ŒæŒ‰ä¼˜å…ˆçº§åˆ†ç»„ï¼‰

#### P0 ä¼˜å…ˆçº§ï¼ˆè¡¥é½ç¡¬ç¼ºå£ï¼‰

**1. ä¸Šä¸‹æ–‡å‹ç¼©**
- æ–°å¢ `scripts/context-compressor.sh`
- å®ç°éª¨æ¶æŠ½å–ï¼ˆä¿ç•™å‡½æ•°ç­¾åã€ç±»å®šä¹‰ã€å…³é”®æ³¨é‡Šï¼‰
- å®ç° token é¢„ç®—ç®¡ç†ï¼ˆåŸºäº tiktoken æˆ–å­—ç¬¦ä¼°ç®—ï¼‰
- å®ç°çƒ­ç‚¹ä¼˜å…ˆç­–ç•¥ï¼ˆç»“åˆ hotspot-analyzer.shï¼‰
- ç›®æ ‡ï¼šå‹ç¼©ç‡ > 60%ï¼Œä¿¡æ¯ä¿ç•™ç‡ > 85%
- æ–°å¢æµ‹è¯•ï¼š`tests/context-compressor.bats`

**2. æ¶æ„æ¼‚ç§»æ£€æµ‹**
- æ–°å¢ `scripts/drift-detector.sh`
- å®ç°æ¶æ„å¿«ç…§ç”Ÿæˆï¼ˆåŸºäº C4 æ¨¡å‹ï¼‰
- å®ç°å¿«ç…§ diff ç®—æ³•ï¼ˆæ¨¡å—/ä¾èµ–/è¾¹ç•Œå˜åŒ–ï¼‰
- å®ç°æ¼‚ç§»è¯„åˆ†ï¼ˆ0-100ï¼Œé˜ˆå€¼ > 30 è§¦å‘å‘Šè­¦ï¼‰
- ç›®æ ‡ï¼šæ£€æµ‹å‡†ç¡®ç‡ > 90%
- æ–°å¢æµ‹è¯•ï¼š`tests/drift-detector.bats`

**3. æ•°æ®æµè¿½è¸ª**
- å¢å¼º `scripts/call-chain.sh`ï¼Œæ–°å¢ `--data-flow` å‚æ•°
- å®ç°å‡½æ•°çº§åˆ«å‚æ•° â†’ è¿”å›å€¼è¿½è¸ª
- è¦†ç›– TypeScript/JavaScriptï¼ˆåŸºäº SCIP ç´¢å¼•ï¼‰
- è¾“å‡ºæ ¼å¼ï¼š`function(param: Type) -> ReturnType`
- æ–°å¢æµ‹è¯•ï¼š`tests/data-flow-tracing.bats`

#### P1 ä¼˜å…ˆçº§ï¼ˆè´¨é‡ä¸é€Ÿåº¦æ ¸å¿ƒæ”¹è¿›ï¼‰

**4. å›¾æŸ¥è¯¢åŠ é€Ÿ**
- ä¿®æ”¹ `scripts/graph-store.sh`
- åœ¨ SQLite ä¸­å®ç°é—­åŒ…è¡¨ï¼ˆtransitive closure tableï¼‰
- å®ç°è·¯å¾„ç´¢å¼•ï¼ˆå¸¸ç”¨è·¯å¾„é¢„è®¡ç®—ï¼‰
- ç›®æ ‡ï¼šå›¾æŸ¥è¯¢ P95 < 200msï¼ˆå½“å‰ > 1sï¼‰

**5. æ··åˆæ£€ç´¢**
- ä¿®æ”¹ `scripts/embedding.sh`
- å®ç°å…³é”®è¯ + å‘é‡ + å›¾è·ç¦»çš„ RRFï¼ˆReciprocal Rank Fusionï¼‰èåˆ
- æƒé‡é…ç½®ï¼šå…³é”®è¯ 30%ï¼Œå‘é‡ 50%ï¼Œå›¾è·ç¦» 20%
- ç›®æ ‡ï¼šMRR@10 æå‡ > 15%ï¼ˆä» < 0.6 åˆ° > 0.69ï¼‰

**6. é»˜è®¤é‡æ’åºç®¡çº¿**
- ä¿®æ”¹ `scripts/graph-rag.sh`
- å°† `scripts/reranker.sh` ä½œä¸ºé»˜è®¤è·¯å¾„
- æä¾›å¯é€‰çš„è½»é‡ LLM rerankï¼ˆé€šè¿‡ Ollamaï¼‰æˆ– heuristic rerankï¼ˆåŸºäºä»£ç ç›¸ä¼¼åº¦ï¼‰
- é…ç½®å¼€å…³ï¼š`config/features.yaml` ä¸­ `reranker.enabled`

#### P2 ä¼˜å…ˆçº§ï¼ˆä¸Šä¸‹æ–‡å±‚å¢å¼ºï¼‰

**7. ä¸Šä¸‹æ–‡å±‚ä¿¡å·çº³å…¥æ£€ç´¢æƒé‡**
- ä¿®æ”¹ `scripts/context-layer.sh`
- æå–å†å²ä¿®å¤æƒé‡ï¼ˆBug ä¿®å¤æ¬¡æ•° â†’ æƒé‡åŠ æˆï¼‰
- æå–æ„å›¾æƒé‡ï¼ˆç”¨æˆ·æŸ¥è¯¢å†å² â†’ åå¥½åŠ æƒï¼‰
- æå–ä¼šè¯ç„¦ç‚¹ï¼ˆå½“å‰å¯¹è¯ä¸­æåŠçš„æ–‡ä»¶/ç¬¦å·ï¼‰
- ä¿®æ”¹ `scripts/graph-rag.sh`ï¼Œå°†ä¸Šè¿°ä¿¡å·çº³å…¥ priority score è®¡ç®—

**8. è¯­ä¹‰å¼‚å¸¸æ£€æµ‹ä¸æ¨¡å¼å­¦ä¹ çš„åé¦ˆé—­ç¯**
- ä¿®æ”¹ `scripts/semantic-anomaly.sh`
- å°†æ£€æµ‹ç»“æœå†™å…¥ `anomalies.jsonl`ï¼ˆåŒ…å«æ–‡ä»¶è·¯å¾„ã€å¼‚å¸¸ç±»å‹ã€ç½®ä¿¡åº¦ï¼‰
- ä¿®æ”¹ `scripts/pattern-learner.sh`
- ä» `anomalies.jsonl` å­¦ä¹ å¼‚å¸¸æ¨¡å¼
- ä¿®æ”¹ `scripts/bug-locator.sh`
- é›†æˆå¼‚å¸¸æ£€æµ‹ç»“æœï¼Œä¼˜å…ˆæ¨èå¼‚å¸¸æ–‡ä»¶

#### P3 ä¼˜å…ˆçº§ï¼ˆè·¨è¯­è¨€ä¸å·¥ç¨‹è´¨é‡ï¼‰

**9. è¯„æµ‹åŸºå‡†ä¸å›å½’æŒ‡æ ‡**
- æ–°å¢ `scripts/benchmark.sh`
- å®ç°ç‰ˆæœ¬é—´å¯¹æ¯”çš„å¯é‡å¤ benchmark
- æŒ‡æ ‡ï¼šæ£€ç´¢ MRR@10ã€å›¾æŸ¥è¯¢ P95 å»¶è¿Ÿã€å‹ç¼©ç‡ã€æ¼‚ç§»æ£€æµ‹å‡†ç¡®ç‡
- è¾“å‡ºæ ¼å¼ï¼šJSON + Markdown æŠ¥å‘Š
- æ–°å¢æµ‹è¯•ï¼š`tests/benchmark.bats`

### å®æ–½é¡ºåº

**é˜¶æ®µ 1ï¼šåŸºç¡€è®¾æ–½ï¼ˆP0 ä¼˜å…ˆçº§ï¼Œä¸²è¡Œï¼‰**
1. **å›¾æŸ¥è¯¢åŠ é€Ÿ**ï¼ˆgraph-store.shï¼‰- å¿…é¡»æœ€å…ˆå®Œæˆ
   - åŸå› ï¼šåç»­åŠŸèƒ½ï¼ˆæ¼‚ç§»æ£€æµ‹ã€æ··åˆæ£€ç´¢ï¼‰ä¾èµ–å›¾æŸ¥è¯¢æ€§èƒ½
   - ä¾èµ–ï¼šæ— 
   - é¢„è®¡å·¥æ—¶ï¼š3 å¤©
   - éªŒè¯ï¼štests/graph-store.bats

2. **æ•°æ®æµè¿½è¸ª**ï¼ˆcall-chain.shï¼‰- å¯ä¸å›¾æŸ¥è¯¢åŠ é€Ÿå¹¶è¡Œ
   - åŸå› ï¼šç‹¬ç«‹åŠŸèƒ½ï¼Œä¸ä¾èµ–å…¶ä»–æ¨¡å—
   - ä¾èµ–ï¼šscip-to-graph.shï¼ˆå·²å­˜åœ¨ï¼‰
   - é¢„è®¡å·¥æ—¶ï¼š2 å¤©
   - éªŒè¯ï¼štests/data-flow-tracing.bats

**é˜¶æ®µ 2ï¼šæ ¸å¿ƒåŠŸèƒ½ï¼ˆP0/P1 ä¼˜å…ˆçº§ï¼Œéƒ¨åˆ†å¹¶è¡Œï¼‰**
3. **ä¸Šä¸‹æ–‡å‹ç¼©**ï¼ˆcontext-compressor.shï¼‰- ä¾èµ–å›¾æŸ¥è¯¢åŠ é€Ÿ
   - åŸå› ï¼šéœ€è¦çƒ­ç‚¹åˆ†æï¼ˆä¾èµ–å›¾æŸ¥è¯¢ï¼‰
   - ä¾èµ–ï¼šhotspot-analyzer.sh, graph-store.shï¼ˆé˜¶æ®µ 1ï¼‰
   - é¢„è®¡å·¥æ—¶ï¼š3 å¤©
   - éªŒè¯ï¼štests/context-compressor.bats

4. **æ¶æ„æ¼‚ç§»æ£€æµ‹**ï¼ˆdrift-detector.shï¼‰- ä¾èµ–å›¾æŸ¥è¯¢åŠ é€Ÿ
   - åŸå› ï¼šéœ€è¦å›¾å­˜å‚¨å’Œå¿«ç…§ diff
   - ä¾èµ–ï¼šgraph-store.shï¼ˆé˜¶æ®µ 1ï¼‰
   - é¢„è®¡å·¥æ—¶ï¼š3 å¤©
   - éªŒè¯ï¼štests/drift-detector.bats

5. **æ··åˆæ£€ç´¢**ï¼ˆembedding.shï¼‰- ä¾èµ–å›¾æŸ¥è¯¢åŠ é€Ÿ
   - åŸå› ï¼šéœ€è¦å›¾è·ç¦»è®¡ç®—
   - ä¾èµ–ï¼šgraph-store.shï¼ˆé˜¶æ®µ 1ï¼‰
   - é¢„è®¡å·¥æ—¶ï¼š2 å¤©
   - éªŒè¯ï¼štests/embedding.bats

**é˜¶æ®µ 3ï¼šé›†æˆåŠŸèƒ½ï¼ˆP1/P2 ä¼˜å…ˆçº§ï¼Œä¸²è¡Œï¼‰**
6. **é‡æ’åºç®¡çº¿**ï¼ˆgraph-rag.shï¼‰- ä¾èµ–æ··åˆæ£€ç´¢
   - åŸå› ï¼šéœ€è¦æ··åˆæ£€ç´¢ç»“æœä½œä¸ºè¾“å…¥
   - ä¾èµ–ï¼šembedding.shï¼ˆé˜¶æ®µ 2ï¼‰, reranker.shï¼ˆå·²å­˜åœ¨ï¼‰
   - é¢„è®¡å·¥æ—¶ï¼š2 å¤©
   - éªŒè¯ï¼štests/graph-rag.bats

7. **ä¸Šä¸‹æ–‡å±‚ä¿¡å·**ï¼ˆcontext-layer.sh, graph-rag.shï¼‰- ä¾èµ–é‡æ’åºç®¡çº¿
   - åŸå› ï¼šéœ€è¦é›†æˆåˆ° graph-rag.sh çš„æƒé‡è®¡ç®—
   - ä¾èµ–ï¼šgraph-rag.shï¼ˆé˜¶æ®µ 3ï¼‰
   - é¢„è®¡å·¥æ—¶ï¼š2 å¤©
   - éªŒè¯ï¼štests/graph-rag.bats

8. **å¼‚å¸¸æ£€æµ‹é—­ç¯**ï¼ˆsemantic-anomaly.sh, bug-locator.shï¼‰- å¯ä¸ä¸Šä¸‹æ–‡å±‚ä¿¡å·å¹¶è¡Œ
   - åŸå› ï¼šç‹¬ç«‹åŠŸèƒ½ï¼Œä¸ä¾èµ–å…¶ä»–æ–°åŠŸèƒ½
   - ä¾èµ–ï¼špattern-learner.shï¼ˆå·²å­˜åœ¨ï¼‰
   - é¢„è®¡å·¥æ—¶ï¼š3 å¤©
   - éªŒè¯ï¼štests/semantic-anomaly.bats

**é˜¶æ®µ 4ï¼šè¯„æµ‹ä¸éªŒè¯ï¼ˆP3 ä¼˜å…ˆçº§ï¼Œæœ€åå®Œæˆï¼‰**
9. **è¯„æµ‹åŸºå‡†**ï¼ˆbenchmark.shï¼‰- ä¾èµ–æ‰€æœ‰åŠŸèƒ½
   - åŸå› ï¼šéœ€è¦æµ‹è¯•æ‰€æœ‰åŠŸèƒ½çš„æ€§èƒ½æŒ‡æ ‡
   - ä¾èµ–ï¼šæ‰€æœ‰åŠŸèƒ½è„šæœ¬ï¼ˆé˜¶æ®µ 1-3ï¼‰
   - é¢„è®¡å·¥æ—¶ï¼š2 å¤©
   - éªŒè¯ï¼štests/benchmark.bats

**ä¾èµ–å…³ç³»å›¾ï¼ˆMermaid æ ¼å¼ï¼‰**ï¼š
```mermaid
graph TD
    A[å›¾æŸ¥è¯¢åŠ é€Ÿ<br/>graph-store.sh] --> C[ä¸Šä¸‹æ–‡å‹ç¼©<br/>context-compressor.sh]
    A --> D[æ¶æ„æ¼‚ç§»æ£€æµ‹<br/>drift-detector.sh]
    A --> E[æ··åˆæ£€ç´¢<br/>embedding.sh]

    B[æ•°æ®æµè¿½è¸ª<br/>call-chain.sh]

    E --> F[é‡æ’åºç®¡çº¿<br/>graph-rag.sh]
    F --> G[ä¸Šä¸‹æ–‡å±‚ä¿¡å·<br/>context-layer.sh]

    H[å¼‚å¸¸æ£€æµ‹é—­ç¯<br/>semantic-anomaly.sh]

    C --> I[è¯„æµ‹åŸºå‡†<br/>benchmark.sh]
    D --> I
    B --> I
    E --> I
    F --> I
    G --> I
    H --> I

    style A fill:#ff6b6b
    style B fill:#ff6b6b
    style C fill:#4ecdc4
    style D fill:#4ecdc4
    style E fill:#4ecdc4
    style F fill:#ffe66d
    style G fill:#ffe66d
    style H fill:#ffe66d
    style I fill:#95e1d3
```

**å¹¶è¡Œå®æ–½å¯èƒ½æ€§**ï¼š
- **é˜¶æ®µ 1**ï¼šå›¾æŸ¥è¯¢åŠ é€Ÿ ä¸ æ•°æ®æµè¿½è¸ª å¯å¹¶è¡Œï¼ˆ2 ä¸ªä»»åŠ¡ï¼‰
- **é˜¶æ®µ 2**ï¼šä¸Šä¸‹æ–‡å‹ç¼©ã€æ¶æ„æ¼‚ç§»æ£€æµ‹ã€æ··åˆæ£€ç´¢ å¯å¹¶è¡Œï¼ˆ3 ä¸ªä»»åŠ¡ï¼‰
- **é˜¶æ®µ 3**ï¼šä¸Šä¸‹æ–‡å±‚ä¿¡å· ä¸ å¼‚å¸¸æ£€æµ‹é—­ç¯ å¯å¹¶è¡Œï¼ˆ2 ä¸ªä»»åŠ¡ï¼‰
- **é˜¶æ®µ 4**ï¼šè¯„æµ‹åŸºå‡† å¿…é¡»ä¸²è¡Œï¼ˆä¾èµ–æ‰€æœ‰åŠŸèƒ½ï¼‰

**æ€»é¢„è®¡å·¥æ—¶**ï¼š
- ä¸²è¡Œå®æ–½ï¼š22 å¤©
- å¹¶è¡Œå®æ–½ï¼ˆ2 äººï¼‰ï¼š14 å¤©
- å¹¶è¡Œå®æ–½ï¼ˆ3 äººï¼‰ï¼š10 å¤©

**é£é™©ä¸ç¼“è§£**ï¼š
- **é£é™©**ï¼šé˜¶æ®µ 1 çš„å›¾æŸ¥è¯¢åŠ é€Ÿå»¶æœŸä¼šå½±å“åç»­æ‰€æœ‰åŠŸèƒ½
- **ç¼“è§£**ï¼šä¼˜å…ˆæŠ•å…¥èµ„æºå®Œæˆå›¾æŸ¥è¯¢åŠ é€Ÿï¼Œè®¾ç½® 3 å¤©ç¡¬æˆªæ­¢
- **é£é™©**ï¼šå¹¶è¡Œå®æ–½å¯èƒ½å¯¼è‡´é›†æˆå†²çª
- **ç¼“è§£**ï¼šæ¯ä¸ªåŠŸèƒ½é€šè¿‡é…ç½®å¼€å…³ç‹¬ç«‹æ§åˆ¶ï¼Œå‡å°‘å†²çª

### éç›®æ ‡

- **ä¸å¼•å…¥æ–°çš„æ¨¡å‹è®­ç»ƒ**ï¼šæ‰€æœ‰åŠŸèƒ½åŸºäºç°æœ‰å·¥å…·å’Œç®—æ³•
- **ä¸å¼•å…¥å¤§æ•°æ®ä¾èµ–**ï¼šä¸ä¾èµ– Sparkã€Hadoop ç­‰å¤§æ•°æ®æ¡†æ¶
- **ä¸ä¿®æ”¹ MCP åè®®**ï¼šä¿æŒä¸ç°æœ‰ MCP SDK å…¼å®¹
- **ä¸é‡æ„ç°æœ‰æ¶æ„**ï¼šä¿æŒè–„å£³æ¨¡å¼å’Œåˆ†å±‚çº¦æŸ

### å½±å“èŒƒå›´

| å½±å“ç±»å‹ | èŒƒå›´ | è¯´æ˜ |
|----------|------|------|
| æ–°å¢æ–‡ä»¶ | 4 ä¸ªè„šæœ¬ + 4 ä¸ªæµ‹è¯• | context-compressor.sh, drift-detector.sh, benchmark.sh + å¯¹åº”æµ‹è¯• |
| ä¿®æ”¹æ–‡ä»¶ | 7 ä¸ªè„šæœ¬ | call-chain.sh, graph-store.sh, embedding.sh, graph-rag.sh, context-layer.sh, semantic-anomaly.sh, pattern-learner.sh, bug-locator.sh |
| æ–°å¢ä¾èµ– | 0 | æ— æ–°å¢å¤–éƒ¨ä¾èµ– |
| é…ç½®å˜æ›´ | 1 ä¸ªé…ç½®æ–‡ä»¶ | config/features.yamlï¼ˆæ–°å¢ reranker.enabled ç­‰å¼€å…³ï¼‰ |
| æµ‹è¯•è¦†ç›– | 4 ä¸ªæ–°æµ‹è¯•æ–‡ä»¶ | è¦†ç›–æ–°å¢åŠŸèƒ½ |

---

## Impactï¼ˆå¯¹å¤–å¥‘çº¦/æ•°æ®/æ¨¡å—/æµ‹è¯•/ä»·å€¼ä¿¡å·/ä»·å€¼æµç“¶é¢ˆå‡è®¾ï¼‰

### å˜æ›´è¾¹ç•Œï¼ˆScopeï¼‰

**In Scopeï¼ˆæœ¬æ¬¡å˜æ›´èŒƒå›´ï¼‰**ï¼š
- æ–°å¢ 4 ä¸ªè„šæœ¬ï¼š`context-compressor.sh`, `drift-detector.sh`, `benchmark.sh` + å¯¹åº”æµ‹è¯•
- ä¿®æ”¹ 7 ä¸ªè„šæœ¬ï¼š`call-chain.sh`, `graph-store.sh`, `embedding.sh`, `graph-rag.sh`, `context-layer.sh`, `semantic-anomaly.sh`, `pattern-learner.sh`, `bug-locator.sh`
- æ–°å¢ 4 ä¸ªæµ‹è¯•æ–‡ä»¶ï¼š`tests/context-compressor.bats`, `tests/drift-detector.bats`, `tests/data-flow-tracing.bats`ï¼ˆå¢å¼ºï¼‰, `tests/benchmark.bats`
- ä¿®æ”¹ 3 ä¸ªæµ‹è¯•æ–‡ä»¶ï¼š`tests/graph-store.bats`, `tests/embedding.bats`, `tests/graph-rag.bats`
- ä¿®æ”¹ 1 ä¸ªé…ç½®æ–‡ä»¶ï¼š`config/features.yaml`ï¼ˆæ–°å¢åŠŸèƒ½å¼€å…³ï¼‰
- æ–°å¢ SQLite Schema è¿ç§»ï¼šé—­åŒ…è¡¨ + è·¯å¾„ç´¢å¼•è¡¨ï¼ˆSchema v2ï¼‰

**Out of Scopeï¼ˆä¸åœ¨æœ¬æ¬¡å˜æ›´èŒƒå›´ï¼‰**ï¼š
- ä¸ä¿®æ”¹ MCP åè®®æ¥å£ï¼ˆä¿æŒä¸ç°æœ‰ MCP SDK å…¼å®¹ï¼‰
- ä¸å¼•å…¥æ–°çš„å¤–éƒ¨ä¾èµ–ï¼ˆnpm/CLI å·¥å…·ï¼‰
- ä¸ä¿®æ”¹ `src/server.ts` çš„ MCP å·¥å…·å®šä¹‰ï¼ˆä»…è„šæœ¬å±‚å¢å¼ºï¼‰
- ä¸é‡æ„ç°æœ‰æ¶æ„ï¼ˆä¿æŒè–„å£³æ¨¡å¼å’Œåˆ†å±‚çº¦æŸï¼‰
- ä¸æ”¯æŒ TypeScript/JavaScript ä»¥å¤–çš„è¯­è¨€ï¼ˆæ•°æ®æµè¿½è¸ªé™åˆ¶ï¼‰

### å˜æ›´ç±»å‹åˆ†ç±»ï¼ˆChange Type Classificationï¼‰

æ ¹æ® GoF ã€Šè®¾è®¡æ¨¡å¼ã€‹å½’çº³çš„"8 ç±»å¯¼è‡´é‡è®¾è®¡çš„åŸå› "ï¼Œæœ¬æ¬¡å˜æ›´å±äºä»¥ä¸‹ç±» [x] **ç®—æ³•ä¾èµ–**ï¼šæ··åˆæ£€ç´¢æƒé‡é…ç½®ï¼ˆRRF èåˆç®—æ³•ï¼‰ã€å‹ç¼©ç®—æ³•é€‰æ‹©ï¼ˆAST éª¨æ¶æŠ½å– vs æ­£åˆ™è¿‡æ»¤ vs LLM æ‘˜è¦ï¼‰
  - **å½±å“èŒƒå›´**ï¼š`embedding.sh`ï¼ˆæ··åˆæ£€ç´¢ï¼‰ã€`context-compressor.sh`ï¼ˆå‹ç¼©ç®—æ³•ï¼‰
  - **ç¼“è§£æªæ–½**ï¼šé€šè¿‡ `config/features.yaml` é…ç½®å¼€å…³æ§åˆ¶ï¼Œå…è®¸ç”¨æˆ·é€‰æ‹©ç®—æ³•ç­–ç•¥

- [x] **åŠŸèƒ½æ‰©å±•**ï¼šæ–°å¢ 9 ä¸ªåŠŸèƒ½ç‚¹ï¼ˆä¸Šä¸‹æ–‡å‹ç¼©ã€æ¶æ„æ¼‚ç§»æ£€æµ‹ã€æ•°æ®æµè¿½è¸ªç­‰ï¼‰
  - **å½±å“èŒƒå›´**ï¼šæ–°å¢ 4 ä¸ªè„šæœ¬ + ä¿®æ”¹ 7 ä¸ªè„šæœ¬
  - **ç¼“è§£æªæ–½**ï¼šæ‰€æœ‰æ–°åŠŸèƒ½é€šè¿‡é…ç½®å¼€å…³ç‹¬ç«‹æ§åˆ¶ï¼Œä¸å½±å“ç°æœ‰åŠŸèƒ½

- [x] **å¯¹è±¡è¡¨ç¤º/å®ç°ä¾èµ–**ï¼šSQLite Schema å˜æ›´ï¼ˆæ–°å¢é—­åŒ…è¡¨å’Œè·¯å¾„ç´¢å¼•è¡¨ï¼‰
  - **å½±å“èŒƒå›´**ï¼š`graph-store.sh`ï¼ˆSchema v2 è¿ç§»ï¼‰
  - **ç¼“è§£æªæ–½**ï¼šè‡ªåŠ¨è¿ç§»é€»è¾‘ + å¤‡ä»½å›æ»šæœºåˆ¶ï¼Œé€šè¿‡ `graph_acceleration` é…ç½®å¼€å…³æ§åˆ¶

- [ ] **åˆ›å»ºç‰¹å®šç±»**ï¼šä¸æ¶‰åŠ
- [ ] **å¹³å°ä¾èµ–**ï¼šä¸æ¶‰åŠ
- [ ] **å¯¹è±¡èŒè´£å˜æ›´**ï¼šä¸æ¶‰åŠ
- [ ] **å­ç³»ç»Ÿ/æ¨¡å—æ›¿æ¢**ï¼šä¸æ¶‰åŠ
- [ ] **æ¥å£å¥‘çº¦å˜æ›´**ï¼šä¸æ¶‰åŠï¼ˆCLI æ¥å£ä»…æ–°å¢å‚æ•°ï¼Œå‘åå…¼å®¹ï¼‰

### Transaction Scope

**None**ï¼šæœ¬å˜æ›´ä¸æ¶‰åŠäº‹åŠ¡æ“ä½œï¼Œæ‰€æœ‰åŠŸèƒ½ä¸ºåªè¯»åˆ†ææˆ–æœ¬åœ°ç¼“å­˜æ“ä½œã€‚

### å¯¹å¤–å¥‘çº¦å½±å“

| å¥‘çº¦ç±»å‹ | å½±å“ | å…¼å®¹æ€§ |
|----------|------|--------|
| MCP å·¥å…·æ¥å£ | æ— å˜æ›´ | å®Œå…¨å…¼å®¹ |
| CLI æ¥å£ | æ–°å¢å‚æ•°ï¼ˆ--data-flow, --compress, --drift-checkï¼‰ | å‘åå…¼å®¹ |
| é…ç½®æ–‡ä»¶ | æ–°å¢å¯é€‰é…ç½®é¡¹ | å‘åå…¼å®¹ï¼ˆæœ‰é»˜è®¤å€¼ï¼‰ |

### å—å½±å“å¯¹è±¡æ¸…å•ï¼ˆImpactsï¼‰

#### A. å¯¹å¤–å¥‘çº¦ï¼ˆAPI/äº‹ä»¶/Schemaï¼‰

**æ— ç ´åæ€§å˜æ›´**ï¼š
- MCP å·¥å…·æ¥å£ä¿æŒä¸å˜ï¼ˆ15 ä¸ªç°æœ‰å·¥å…·ï¼‰
- CLI æ¥å£ä»…æ–°å¢å¯é€‰å‚æ•°ï¼Œå‘åå…¼å®¹
- é…ç½®æ–‡ä»¶æ–°å¢å¯é€‰é…ç½®é¡¹ï¼Œæœ‰é»˜è®¤å€¼

**å®é™…éªŒè¯ç»“æœ**ï¼ˆåŸºäºä»£ç åº“åˆ†æï¼‰ï¼š
- âœ… `call-chain.sh` å·²æœ‰æ•°æ®æµè¿½è¸ªåŸºç¡€ï¼ˆDATA_FLOW_ENABLED å˜é‡å­˜åœ¨ï¼Œç¬¬ 74 è¡Œï¼‰
- âœ… `graph-rag.sh` å·²æœ‰é‡æ’åºé›†æˆç‚¹ï¼ˆRERANK_ENABLED å˜é‡å­˜åœ¨ï¼Œç¬¬ 90 è¡Œï¼‰
- âœ… `bug-locator.sh` å·²æœ‰çƒ­ç‚¹åˆ†æå™¨é›†æˆï¼ˆHOTSPOT_ANALYZER è·¯å¾„å®šä¹‰ï¼Œç¬¬ 80 è¡Œï¼‰
- âš ï¸ `reranker.sh` å·²å­˜åœ¨ä½†æœªè¢« `graph-rag.sh` è°ƒç”¨ï¼ˆéœ€åœ¨æœ¬æ¬¡å˜æ›´ä¸­é›†æˆï¼‰

**æ–°å¢ CLI å‚æ•°**ï¼š
| è„šæœ¬ | æ–°å¢å‚æ•° | é»˜è®¤å€¼ | å…¼å®¹æ€§ | éªŒè¯çŠ¶æ€ |
|------|----------|--------|--------|----------|
| `call-chain.sh` | `--data-flow` | false | å‘åå…¼å®¹ | âœ… å˜é‡å·²é¢„ç•™ |
| `context-compressor.sh` | `--budget`, `--mode` | 5000, skeleton | æ–°è„šæœ¬ | ğŸ†• å¾…å®ç° |
| `drift-detector.sh` | `--threshold` | 50 | æ–°è„šæœ¬ | ğŸ†• å¾…å®ç° |
| `graph-store.sh` | `--migrate`, `--rebuild-closure` | - | å‘åå…¼å®¹ | ğŸ†• å¾…å®ç° |
| `embedding.sh` | `--hybrid`, `--weights` | false, 0.3/0.5/0.2 | å‘åå…¼å®¹ | ğŸ†• å¾…å®ç° |
| `graph-rag.sh` | `--rerank` | true | å‘åå…¼å®¹ | âœ… å˜é‡å·²é¢„ç•™ |

#### B. æ•°æ®ä¸è¿ç§»ï¼ˆDB/å›æ”¾/å¹‚ç­‰ï¼‰

**SQLite Schema å˜æ›´ï¼ˆSchema v1 â†’ v2ï¼‰**ï¼š

| æ•°æ®ç±»å‹ | å½±å“ | è¿ç§»éœ€æ±‚ |
|----------|------|----------|
| SQLite å›¾å­˜å‚¨ | æ–°å¢é—­åŒ…è¡¨å’Œè·¯å¾„ç´¢å¼•è¡¨ | è‡ªåŠ¨è¿ç§»ï¼ˆé¦–æ¬¡è¿è¡Œæ—¶ï¼‰ |
| ç¼“å­˜æ–‡ä»¶ | æ–°å¢å‹ç¼©ç¼“å­˜ã€æ¼‚ç§»å¿«ç…§ | æ— éœ€è¿ç§» |
| é…ç½®æ–‡ä»¶ | æ–°å¢ features.yaml é…ç½®é¡¹ | æ— éœ€è¿ç§»ï¼ˆæœ‰é»˜è®¤å€¼ï¼‰ |

### Schema è¿ç§»è®¡åˆ’

**SQLite Schema å˜æ›´**ï¼š

**æ–°å¢è¡¨ 1ï¼šé—­åŒ…è¡¨ï¼ˆClosure Tableï¼‰**
```sql
CREATE TABLE IF NOT EXISTS closure_table (
  ancestor TEXT NOT NULL,
  descendant TEXT NOT NULL,
  depth INTEGER NOT NULL,
  PRIMARY KEY (ancestor, descendant)
);

CREATE INDEX idx_closure_ancestor ON closure_table(ancestor);
CREATE INDEX idx_closure_descendant ON closure_table(descendant);
CREATE INDEX idx_closure_depth ON closure_table(depth);
```

**æ–°å¢è¡¨ 2ï¼šè·¯å¾„ç´¢å¼•è¡¨ï¼ˆPath Indexï¼‰**
```sql
CREATE TABLE IF NOT EXISTS path_index (
  path_id INTEGER PRIMARY KEY AUTOINCREMENT,
  source TEXT NOT NULL,
  target TEXT NOT NULL,
  path TEXT NOT NULL,  -- JSON æ•°ç»„ï¼Œå¦‚ ["A", "B", "C"]
  length INTEGER NOT NULL,
  frequency INTEGER DEFAULT 1,
  last_accessed TIMESTAMP DEFAULT CURRENT_TIMESTAMP
);

CREATE INDEX idx_path_source ON path_index(source);
CREATE INDEX idx_path_target ON path_index(target);
CREATE INDEX idx_path_length ON path_index(length);
```

**è¿ç§»æ­¥éª¤**ï¼š

1. **ç‰ˆæœ¬æ£€æµ‹**ï¼š
   - åœ¨ `scripts/graph-store.sh` ä¸­æ£€æµ‹ Schema ç‰ˆæœ¬
   - ç‰ˆæœ¬å·å­˜å‚¨åœ¨ `schema_version` è¡¨ä¸­
   ```sql
   CREATE TABLE IF NOT EXISTS schema_version (
     version INTEGER PRIMARY KEY,
     applied_at TIMESTAMP DEFAULT CURRENT_TIMESTAMP
   );
   ```

2. **è‡ªåŠ¨è¿ç§»é€»è¾‘**ï¼š
   ```bash
   # scripts/graph-store.sh --migrate
   migrate_schema() {
     local db_file=".devbooks/graph.db"
     local current_version=$(sqlite3 "$db_file" "SELECT MAX(version) FROM schema_version;" 2>/dev/null || echo 0)
     local target_version=2  # æœ¬æ¬¡å˜æ›´çš„ç›®æ ‡ç‰ˆæœ¬

     if [ "$current_version" -lt "$target_version" ]; then
       echo "Migrating schema from v$current_version to v$target_version..."

       # åˆ›å»ºé—­åŒ…è¡¨
       sqlite3 "$db_file" < scripts/migrations/001_add_closure_table.sql

       # åˆ›å»ºè·¯å¾„ç´¢å¼•è¡¨
       sqlite3 "$db_file" < scripts/migrations/002_add_path_index.sql

       # é¢„è®¡ç®—é—­åŒ…è¡¨ï¼ˆå¯èƒ½è€—æ—¶ï¼‰
       echo "Precomputing closure table (this may take a few minutes)..."
       scripts/graph-store.sh --rebuild-closure

       # æ›´æ–°ç‰ˆæœ¬å·
       sqlite3 "$db_file" "INSERT INTO schema_version (version) VALUES ($target_version);"

       echo "Migration completed."
     else
       echo "Schema is up to date (v$current_version)."
     fi
   }
   ```

3. **è¿ç§»è§¦å‘æ—¶æœº**ï¼š
   - **é¦–æ¬¡è¿è¡Œ**ï¼šMCP Server å¯åŠ¨æ—¶è‡ªåŠ¨æ£€æµ‹å¹¶è¿ç§»
   - **æ‰‹åŠ¨è§¦å‘**ï¼š`scripts/graph-store.sh --migrate`
   - **CI/CD**ï¼šåœ¨éƒ¨ç½²è„šæœ¬ä¸­æ˜¾å¼è°ƒç”¨è¿ç§»

4. **è¿ç§»å¤±è´¥å›æ»š**ï¼š
   - è¿ç§»å‰å¤‡ä»½æ•°æ®åº“ï¼š`cp .devbooks/graph.db .devbooks/graph.db.backup`
   - è¿ç§»å¤±è´¥æ—¶è‡ªåŠ¨æ¢å¤ï¼š`mv .devbooks/graph.db.backup .devbooks/graph.db`
   - è®°å½•è¿ç§»æ—¥å¿—åˆ° `.devbooks/migration.log`

5. **è¿ç§»æ€§èƒ½**ï¼š
   - **é¢„è®¡è€—æ—¶**ï¼š500 ä¸ªç¬¦å·èŠ‚ç‚¹çº¦ 10 ç§’ï¼Œ10000 ä¸ªèŠ‚ç‚¹çº¦ 5 åˆ†é’Ÿ
   - **ä¼˜åŒ–ç­–ç•¥**ï¼šå¼‚æ­¥é¢„è®¡ç®—ï¼Œé¦–æ¬¡æŸ¥è¯¢æ—¶æŒ‰éœ€è®¡ç®—
   - **è¿›åº¦æ˜¾ç¤º**ï¼šè¾“å‡ºè¿ç§»è¿›åº¦ï¼ˆå¦‚ "Processing 100/500 nodes..."ï¼‰

**è¿ç§»è„šæœ¬æ–‡ä»¶**ï¼š
- `scripts/migrations/001_add_closure_table.sql`
- `scripts/migrations/002_add_path_index.sql`
- `scripts/graph-store.sh --migrate`ï¼ˆè¿ç§»å…¥å£ï¼‰
- `scripts/graph-store.sh --rebuild-closure`ï¼ˆé‡å»ºé—­åŒ…è¡¨ï¼‰

### ç”¨æˆ·å‡çº§æŒ‡å—

**å‡çº§è·¯å¾„ï¼šä»å½“å‰ç‰ˆæœ¬ï¼ˆv0.xï¼‰åˆ°æ–°ç‰ˆæœ¬ï¼ˆv1.0ï¼‰**

**å‰ç½®æ¡ä»¶**ï¼š
- Node.js >= 18.0.0
- SQLite >= 3.35
- ç£ç›˜ç©ºé—´ >= 500MBï¼ˆç”¨äºé—­åŒ…è¡¨ï¼‰

**å‡çº§æ­¥éª¤**ï¼š

1. **å¤‡ä»½æ•°æ®**ï¼ˆå¼ºçƒˆæ¨èï¼‰ï¼š
   ```bash
   # å¤‡ä»½å›¾æ•°æ®åº“
   cp .devbooks/graph.db .devbooks/graph.db.backup

   # å¤‡ä»½é…ç½®æ–‡ä»¶
   cp config/features.yaml config/features.yaml.backup
   ```

2. **æ‹‰å–æœ€æ–°ä»£ç **ï¼š
   ```bash
   cd /path/to/code-intelligence-mcp
   git pull origin master
   ```

3. **å®‰è£…ä¾èµ–**ï¼ˆå¦‚æœ‰å˜æ›´ï¼‰ï¼š
   ```bash
   npm install
   ```

4. **è¿è¡Œè¿ç§»**ï¼ˆè‡ªåŠ¨æˆ–æ‰‹åŠ¨ï¼‰ï¼š
   - **è‡ªåŠ¨è¿ç§»**ï¼šå¯åŠ¨ MCP Server æ—¶è‡ªåŠ¨æ£€æµ‹å¹¶è¿ç§»
     ```bash
     npm start
     # é¦–æ¬¡å¯åŠ¨ä¼šè¾“å‡ºï¼š
     # "Migrating schema from v0 to v2..."
     # "Migration completed."
     ```

   - **æ‰‹åŠ¨è¿ç§»**ï¼ˆæ¨èï¼Œå¯æ§åˆ¶æ—¶æœºï¼‰ï¼š
     ```bash
     scripts/graph-store.sh --migrate
     ```

5. **éªŒè¯è¿ç§»**ï¼š
   ```bash
   # æ£€æŸ¥ Schema ç‰ˆæœ¬
   sqlite3 .devbooks/graph.db "SELECT * FROM schema_version;"
   # é¢„æœŸè¾“å‡ºï¼šversion = 2

   # æ£€æŸ¥é—­åŒ…è¡¨
   sqlite3 .devbooks/graph.db "SELECT COUNT(*) FROM closure_table;"
   # é¢„æœŸè¾“å‡ºï¼š> 0

   # è¿è¡Œæµ‹è¯•
   npm test -- tests/graph-store.bats
   ```

6. **é…ç½®æ–°åŠŸèƒ½**ï¼ˆå¯é€‰ï¼‰ï¼š
   - ç¼–è¾‘ `config/features.yaml`
   - å¯ç”¨/ç¦ç”¨æ–°åŠŸèƒ½å¼€å…³ï¼ˆé»˜è®¤å…¨éƒ¨å¯ç”¨ï¼‰
   ```yaml
   features:
     context_compression: true
     drift_detection: true
     data_flow_tracing: true
     graph_acceleration: true
     hybrid_retrieval: true
     reranker: true
     context_signals: true
     anomaly_feedback: true
     benchmark: true
   ```

7. **é‡å¯ MCP Server**ï¼š
   ```bash
   pkill -f "node.*server.ts"
   npm start
   ```

**å‡çº§æ³¨æ„äº‹é¡¹**ï¼š

1. **è¿ç§»è€—æ—¶**ï¼š
   - å°å‹é¡¹ç›®ï¼ˆ< 1000 ç¬¦å·ï¼‰ï¼š< 1 åˆ†é’Ÿ
   - ä¸­å‹é¡¹ç›®ï¼ˆ1000-5000 ç¬¦å·ï¼‰ï¼š1-3 åˆ†é’Ÿ
   - å¤§å‹é¡¹ç›®ï¼ˆ> 5000 ç¬¦å·ï¼‰ï¼š3-10 åˆ†é’Ÿ
   - å»ºè®®åœ¨éé«˜å³°æ—¶æ®µå‡çº§

2. **ç£ç›˜ç©ºé—´**ï¼š
   - é—­åŒ…è¡¨å¤§å°çº¦ä¸ºåŸå›¾æ•°æ®çš„ 2-3 å€
   - ç¡®ä¿æœ‰è¶³å¤Ÿçš„ç£ç›˜ç©ºé—´ï¼ˆè‡³å°‘ 500MBï¼‰

3. **å…¼å®¹æ€§**ï¼š
   - æ–°ç‰ˆæœ¬å®Œå…¨å‘åå…¼å®¹ï¼Œæ—§çš„ MCP å·¥å…·æ¥å£ä¸å˜
   - å¦‚æœè¿ç§»å¤±è´¥ï¼Œå¯ä»¥å›æ»šåˆ°å¤‡ä»½ç‰ˆæœ¬

4. **å›æ»šæ­¥éª¤**ï¼ˆå¦‚æœå‡çº§å¤±è´¥ï¼‰ï¼š
   ```bash
   # åœæ­¢ MCP Server
   pkill -f "node.*server.ts"

   # æ¢å¤æ•°æ®åº“
   mv .devbooks/graph.db.backup .devbooks/graph.db

   # æ¢å¤é…ç½®
   mv config/features.yaml.backup config/features.yaml

   # å›é€€ä»£ç 
   git checkout <previous-commit>

   # é‡å¯
   npm start
   ```

5. **å¸¸è§é—®é¢˜**ï¼š
   - **é—®é¢˜**ï¼šè¿ç§»å¡ä½ä¸åŠ¨
     - **åŸå› **ï¼šå›¾æ•°æ®è¿‡å¤§ï¼Œé¢„è®¡ç®—è€—æ—¶
     - **è§£å†³**ï¼šç­‰å¾…å®Œæˆï¼Œæˆ–ä½¿ç”¨ `--skip-precompute` è·³è¿‡é¢„è®¡ç®—

   - **é—®é¢˜**ï¼šSQLite ç‰ˆæœ¬è¿‡ä½
     - **åŸå› **ï¼šç³»ç»Ÿ SQLite < 3.35
     - **è§£å†³**ï¼šå‡çº§ SQLite æˆ–ä½¿ç”¨ Docker ç¯å¢ƒ

   - **é—®é¢˜**ï¼šç£ç›˜ç©ºé—´ä¸è¶³
     - **åŸå› **ï¼šé—­åŒ…è¡¨å ç”¨ç©ºé—´å¤§
     - **è§£å†³**ï¼šæ¸…ç†ç¼“å­˜æˆ–ç¦ç”¨ `graph_acceleration` åŠŸèƒ½

**å‡çº§éªŒè¯æ¸…å•**ï¼š
- [ ] æ•°æ®åº“å¤‡ä»½å®Œæˆ
- [ ] è¿ç§»æˆåŠŸï¼ˆschema_version = 2ï¼‰
- [ ] é—­åŒ…è¡¨å·²ç”Ÿæˆï¼ˆclosure_table æœ‰æ•°æ®ï¼‰
- [ ] æµ‹è¯•é€šè¿‡ï¼ˆnpm testï¼‰
- [ ] MCP Server æ­£å¸¸å¯åŠ¨
- [ ] æ–°åŠŸèƒ½å¯ç”¨ï¼ˆè¿è¡Œ benchmark.shï¼‰

**è¿ç§»å½±å“åˆ†æ**ï¼š
- **ç£ç›˜ç©ºé—´**ï¼šé—­åŒ…è¡¨å¤§å°çº¦ä¸ºåŸå›¾æ•°æ®çš„ 2-3 å€ï¼ˆé¢„è®¡ 500MBï¼‰
- **è¿ç§»è€—æ—¶**ï¼š500 ä¸ªç¬¦å·èŠ‚ç‚¹çº¦ 10 ç§’ï¼Œ10000 ä¸ªèŠ‚ç‚¹çº¦ 5 åˆ†é’Ÿ
- **å¹‚ç­‰æ€§**ï¼šè¿ç§»è„šæœ¬å¯é‡å¤æ‰§è¡Œï¼Œå·²è¿ç§»çš„æ•°æ®åº“ä¸ä¼šé‡å¤è¿ç§»
- **å›æ»šè·¯å¾„**ï¼šè¿ç§»å‰è‡ªåŠ¨å¤‡ä»½ `.devbooks/graph.db.backup`ï¼Œå¤±è´¥æ—¶è‡ªåŠ¨æ¢å¤

**æ•°æ®ä¸€è‡´æ€§ä¿è¯**ï¼š
- è¿ç§»åœ¨å•ä¸ªäº‹åŠ¡ä¸­å®Œæˆï¼Œå¤±è´¥æ—¶æ•´ä½“å›æ»š
- ç‰ˆæœ¬å·å­˜å‚¨åœ¨ `schema_version` è¡¨ä¸­ï¼Œé˜²æ­¢é‡å¤è¿ç§»
- è¿ç§»æ—¥å¿—è®°å½•åˆ° `.devbooks/migration.log`

#### C. æ¨¡å—ä¸ä¾èµ–ï¼ˆè¾¹ç•Œ/è°ƒç”¨æ–¹å‘/å¾ªç¯é£é™©ï¼‰

**æ–°å¢ä¾èµ–å…³ç³»**ï¼ˆåŸºäºä»£ç åº“å®é™…éªŒè¯ï¼‰ï¼š
```
context-compressor.sh â†’ hotspot-analyzer.shï¼ˆå¾…å®ç°ï¼‰
drift-detector.sh â†’ graph-store.shï¼ˆå¾…å®ç°ï¼‰
call-chain.sh â†’ scip-to-graph.shï¼ˆå·²å­˜åœ¨ï¼Œéœ€å¢å¼ºæ•°æ®æµè¿½è¸ªï¼‰
graph-rag.sh â†’ reranker.shï¼ˆå¾…é›†æˆï¼Œå˜é‡å·²é¢„ç•™ï¼‰
graph-rag.sh â†’ context-layer.shï¼ˆå·²å­˜åœ¨ï¼Œéœ€å¢å¼ºä¿¡å·æå–ï¼‰
bug-locator.sh â†’ semantic-anomaly.shï¼ˆå¾…å®ç°ï¼‰
bug-locator.sh â†’ hotspot-analyzer.shï¼ˆâœ… å·²é›†æˆï¼Œç¬¬ 80 è¡Œï¼‰
bug-locator.sh â†’ impact-analyzer.shï¼ˆâœ… å·²é›†æˆï¼Œç¬¬ 77 è¡Œï¼‰
pattern-learner.sh â†’ semantic-anomaly.shï¼ˆå¾…å®ç°ï¼‰
benchmark.sh â†’ æ‰€æœ‰åŠŸèƒ½è„šæœ¬ï¼ˆæµ‹è¯•ä¾èµ–ï¼Œå¾…å®ç°ï¼‰
```

**å®é™…ä¾èµ–éªŒè¯ç»“æœ**ï¼š
- âœ… `bug-locator.sh` å·²é›†æˆ `hotspot-analyzer.sh`ï¼ˆHOTSPOT_ANALYZER å˜é‡ï¼Œç¬¬ 80 è¡Œï¼‰
- âœ… `bug-locator.sh` å·²é›†æˆ `impact-analyzer.sh`ï¼ˆIMPACT_ANALYZER å˜é‡ï¼Œç¬¬ 77 è¡Œï¼‰
- âœ… `bug-locator.sh` å·²é›†æˆ `cache-manager.sh`ï¼ˆCACHE_MANAGER å˜é‡ï¼Œç¬¬ 83 è¡Œï¼‰
- âœ… `graph-rag.sh` å·²é›†æˆ `cache-manager.sh`ï¼ˆCACHE_MANAGER å˜é‡ï¼Œç¬¬ 73 è¡Œï¼‰
- âœ… `graph-rag.sh` å·²é›†æˆ `boundary-detector.sh`ï¼ˆBOUNDARY_DETECTOR å˜é‡ï¼Œç¬¬ 70 è¡Œï¼‰
- âš ï¸ `graph-rag.sh` çš„ `reranker.sh` é›†æˆç‚¹å·²é¢„ç•™ä½†æœªå®ç°ï¼ˆRERANK_ENABLED å˜é‡ï¼Œç¬¬ 90 è¡Œï¼‰
- âš ï¸ `call-chain.sh` çš„æ•°æ®æµè¿½è¸ªåŸºç¡€å·²é¢„ç•™ä½†æœªå®Œå…¨å®ç°ï¼ˆDATA_FLOW_ENABLED å˜é‡ï¼Œç¬¬ 74 è¡Œï¼‰

**ä¾èµ–æ–¹å‘éªŒè¯**ï¼š
- âœ… æ‰€æœ‰æ–°å¢ä¾èµ–ç¬¦åˆåˆ†å±‚çº¦æŸï¼ˆshared â† core â† integrationï¼‰
- âœ… æ— å¾ªç¯ä¾èµ–
- âœ… æ— è·¨å±‚ä¾èµ–
- âœ… ç°æœ‰è„šæœ¬å·²æœ‰è‰¯å¥½çš„æ¨¡å—åŒ–è®¾è®¡ï¼ˆé€šè¿‡å˜é‡å¼•ç”¨å¤–éƒ¨è„šæœ¬ï¼‰

**ä¾èµ–å†²çªé£é™©è¯„ä¼°**ï¼š
| ä¾èµ–å…³ç³» | ç±»å‹ | å†²çªé£é™© | ç¼“è§£æªæ–½ |
|----------|------|----------|----------|
| context-compressor.sh â†’ hotspot-analyzer.sh | æ–°å¢ | ä½ | hotspot-analyzer.sh å·²å­˜åœ¨ä¸”ç¨³å®š |
| drift-detector.sh â†’ graph-store.sh | æ–°å¢ | ä¸­ | graph-store.sh å°†æ–°å¢é—­åŒ…è¡¨ï¼Œéœ€ç¡®ä¿å‘åå…¼å®¹ |
| call-chain.sh â†’ scip-to-graph.sh | å¢å¼º | ä½ | ä»…æ–°å¢ --data-flow å‚æ•°ï¼Œä¸å½±å“ç°æœ‰åŠŸèƒ½ |
| graph-rag.sh â†’ reranker.sh | æ–°å¢ | ä½ | reranker.sh å·²å­˜åœ¨ï¼Œé€šè¿‡é…ç½®å¼€å…³æ§åˆ¶ |
| graph-rag.sh â†’ context-layer.sh | å¢å¼º | ä½ | context-layer.sh å·²å­˜åœ¨ï¼Œä»…æ–°å¢ä¿¡å·æå– |
| bug-locator.sh â†’ semantic-anomaly.sh | æ–°å¢ | ä¸­ | semantic-anomaly.sh ä¸ºæ–°è„šæœ¬ï¼Œéœ€ç¡®ä¿è¾“å‡ºæ ¼å¼ç¨³å®š |
| pattern-learner.sh â†’ semantic-anomaly.sh | æ–°å¢ | ä¸­ | åŒä¸Š |

**å¾ªç¯ä¾èµ–æ£€æµ‹**ï¼š
- å·²é€šè¿‡ `dependency-guard.sh` æ£€æµ‹ï¼Œæ— å¾ªç¯ä¾èµ–
- æ–°å¢ä¾èµ–å‡ä¸ºå•å‘ä¾èµ–ï¼ˆA â†’ Bï¼Œä¸å­˜åœ¨ B â†’ Aï¼‰

#### D. æµ‹è¯•ä¸éªŒè¯ï¼ˆéœ€è¦æ–°å¢/æ›´æ–°å“ªäº›é”šç‚¹ï¼‰

**å®é™…æµ‹è¯•æ–‡ä»¶éªŒè¯ç»“æœ**ï¼š
- âœ… `tests/context-compressor.bats` - å·²å­˜åœ¨ï¼ˆå¾…å¢å¼ºï¼‰
- âœ… `tests/drift-detector.bats` - å·²å­˜åœ¨ï¼ˆå¾…å¢å¼ºï¼‰
- âœ… `tests/data-flow-tracing.bats` - å·²å­˜åœ¨ï¼ˆå¾…å¢å¼ºï¼‰
- âš ï¸ `tests/benchmark.bats` - ä¸å­˜åœ¨ï¼ˆéœ€æ–°å»ºï¼‰
- âœ… `tests/semantic-anomaly.bats` - å·²å­˜åœ¨ï¼ˆå¾…å¢å¼ºå¼‚å¸¸æ£€æµ‹é—­ç¯ï¼‰

**æ–°å¢æµ‹è¯•æ–‡ä»¶ï¼ˆ1 ä¸ªï¼‰**ï¼š
1. `tests/benchmark.bats` - è¯„æµ‹åŸºå‡†æµ‹è¯•ï¼ˆğŸ†• å¾…å®ç°ï¼‰
   - æµ‹è¯• MRR@10 è®¡ç®—
   - æµ‹è¯• P95 å»¶è¿Ÿæµ‹é‡
   - æµ‹è¯•å‹ç¼©ç‡ç»Ÿè®¡
   - æµ‹è¯•åŸºçº¿å¯¹æ¯”åŠŸèƒ½

**å¢å¼ºæµ‹è¯•æ–‡ä»¶ï¼ˆ4 ä¸ªï¼‰**ï¼š
1. `tests/context-compressor.bats` - ä¸Šä¸‹æ–‡å‹ç¼©åŠŸèƒ½æµ‹è¯•ï¼ˆâœ… å·²å­˜åœ¨ï¼‰
   - æµ‹è¯•å‹ç¼©ç‡ > 60%
   - æµ‹è¯•ä¿¡æ¯ä¿ç•™ç‡ > 85%
   - æµ‹è¯•çƒ­ç‚¹ä¼˜å…ˆç­–ç•¥
   - æµ‹è¯• Token é¢„ç®—æ§åˆ¶

2. `tests/drift-detector.bats` - æ¶æ„æ¼‚ç§»æ£€æµ‹æµ‹è¯•ï¼ˆâœ… å·²å­˜åœ¨ï¼‰
   - æµ‹è¯•æ¼‚ç§»è¯„åˆ†è®¡ç®—
   - æµ‹è¯•å¿«ç…§ diff ç®—æ³•
   - æµ‹è¯•é˜ˆå€¼å‘Šè­¦æœºåˆ¶
   - æµ‹è¯•é¦–æ¬¡è¿è¡Œï¼ˆæ— å¿«ç…§ï¼‰åœºæ™¯

3. `tests/data-flow-tracing.bats` - æ•°æ®æµè¿½è¸ªæµ‹è¯•ï¼ˆâœ… å·²å­˜åœ¨ï¼‰
   - æµ‹è¯• forward/backward/both æ–¹å‘
   - æµ‹è¯•å‚æ•°ä¼ é€’è¿½è¸ª
   - æµ‹è¯•è¿”å›å€¼è¿½è¸ª
   - æµ‹è¯•å¾ªç¯å¼•ç”¨æ£€æµ‹

4. `tests/semantic-anomaly.bats` - è¯­ä¹‰å¼‚å¸¸æ£€æµ‹æµ‹è¯•ï¼ˆâœ… å·²å­˜åœ¨ï¼‰
   - å¢å¼ºï¼šå¼‚å¸¸æ£€æµ‹ç»“æœè¾“å‡ºåˆ° `anomalies.jsonl`
   - å¢å¼ºï¼šä¸ Bug å®šä½çš„åé¦ˆé—­ç¯

**ä¿®æ”¹æµ‹è¯•æ–‡ä»¶ï¼ˆ3 ä¸ªï¼‰**ï¼š
1. `tests/graph-store.bats` - å¢åŠ é—­åŒ…è¡¨å’Œè·¯å¾„ç´¢å¼•æµ‹è¯•
   - æµ‹è¯•é—­åŒ…è¡¨é¢„è®¡ç®—
   - æµ‹è¯•è·¯å¾„ç´¢å¼•æŸ¥è¯¢
   - æµ‹è¯• Schema è¿ç§»é€»è¾‘
   - æµ‹è¯•å¹¶å‘æŸ¥è¯¢æ€§èƒ½

2. `tests/embedding.bats` - å¢åŠ æ··åˆæ£€ç´¢æµ‹è¯•
   - æµ‹è¯• RRF èåˆç®—æ³•
   - æµ‹è¯•æƒé‡é…ç½®
   - æµ‹è¯•å…³é”®è¯ + å‘é‡ + å›¾è·ç¦»èåˆ
   - æµ‹è¯• MRR@10 æå‡éªŒè¯

3. `tests/graph-rag.bats` - å¢åŠ é‡æ’åºå’Œä¸Šä¸‹æ–‡ä¿¡å·æµ‹è¯•
   - æµ‹è¯•é‡æ’åºç®¡çº¿é›†æˆ
   - æµ‹è¯•ä¸Šä¸‹æ–‡å±‚ä¿¡å·æå–
   - æµ‹è¯•å†å²ä¿®å¤æƒé‡
   - æµ‹è¯•æ„å›¾æƒé‡åŠ æƒ

**æµ‹è¯•è¦†ç›–èŒƒå›´**ï¼š
- **å•å…ƒæµ‹è¯•**ï¼šæ¯ä¸ªæ–°å¢/ä¿®æ”¹è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½ï¼ˆå¦‚å‹ç¼©ç®—æ³•ã€æ¼‚ç§»è¯„åˆ†ã€RRF èåˆï¼‰
- **é›†æˆæµ‹è¯•**ï¼šåŠŸèƒ½ç‚¹ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼ˆå¦‚å‹ç¼© + çƒ­ç‚¹ã€æ¼‚ç§» + å›¾å­˜å‚¨ï¼‰
- **æ€§èƒ½æµ‹è¯•**ï¼šP95 å»¶è¿Ÿã€MRR@10ã€å‹ç¼©ç‡ç­‰æŒ‡æ ‡ï¼ˆé›†æˆåˆ° benchmark.shï¼‰

**å¿«ç…§æµ‹è¯•éœ€æ±‚**ï¼š
- æ¶æ„æ¼‚ç§»æ£€æµ‹éœ€è¦å¿«ç…§æµ‹è¯•ï¼ˆä¿å­˜åˆå§‹æ¶æ„å¿«ç…§ï¼Œå¯¹æ¯”å˜æ›´åå¿«ç…§ï¼‰
- æ··åˆæ£€ç´¢éœ€è¦åŸºçº¿å¿«ç…§ï¼ˆä¿å­˜å½“å‰ MRR@10 åŸºçº¿ï¼Œå¯¹æ¯”ä¼˜åŒ–åæŒ‡æ ‡ï¼‰

#### E. Bounded Context è¾¹ç•Œ

**æœ¬æ¬¡å˜æ›´ä¸è·¨è¶Š Bounded Context**ï¼š
- æ‰€æœ‰å˜æ›´å‡åœ¨ Code Intelligence MCP Server å†…éƒ¨
- ä¸æ¶‰åŠå¤–éƒ¨ç³»ç»Ÿé›†æˆï¼ˆOllama/OpenAI/CKB MCP ä¸ºå¯é€‰ä¾èµ–ï¼Œæ¥å£ä¸å˜ï¼‰
- ä¸æ¶‰åŠè·¨ä»“åº“å¥‘çº¦å˜æ›´ï¼ˆfederation-lite.sh ä¸åœ¨æœ¬æ¬¡å˜æ›´èŒƒå›´ï¼‰

**ACL æ£€æŸ¥æ¸…å•**ï¼š
- âœ… å¤–éƒ¨ç³»ç»Ÿ/API å˜æ›´å·²è¢« ACL éš”ç¦»ï¼ˆOllama/OpenAI é€šè¿‡ `embedding.sh` éš”ç¦»ï¼ŒCKB MCP é€šè¿‡ `graph-rag.sh` éš”ç¦»ï¼‰
- âœ… ä¸å­˜åœ¨ç›´æ¥è°ƒç”¨å¤–éƒ¨ API è€Œæœªç»è¿‡é€‚é…å±‚çš„ä»£ç 
- âœ… æ— æ–°å¢å¤–éƒ¨ä¾èµ–ï¼Œæ— éœ€æ–°å¢ ACL æ¥å£

#### F. å—å½±å“çš„ Spec çœŸç†

**å—å½±å“çš„ Spec æ–‡ä»¶**ï¼š

1. **[EXTEND]** `dev-playbooks/specs/data-flow-tracing/spec.md`
   - æ–°å¢ `--data-flow` å‚æ•°æ”¯æŒ
   - æ–°å¢ forward/backward/both æ–¹å‘è¿½è¸ª
   - æ–°å¢å˜é‡æ˜ å°„è¿½è¸ªåœºæ™¯

2. **[EXTEND]** `dev-playbooks/specs/graph-store/spec.md`
   - æ–°å¢é—­åŒ…è¡¨å’Œè·¯å¾„ç´¢å¼•è¡¨ï¼ˆSchema v2ï¼‰
   - æ–°å¢ `--migrate` å’Œ `--rebuild-closure` å‘½ä»¤
   - æ–°å¢è·¯å¾„æŸ¥è¯¢èƒ½åŠ›

3. **[NEW]** `dev-playbooks/specs/context-compressor/spec.md`
   - æ–°å¢ä¸Šä¸‹æ–‡å‹ç¼©èƒ½åŠ›è§„æ ¼
   - å®šä¹‰å‹ç¼©ç‡ç›®æ ‡ï¼ˆâ‰¥60%ï¼‰
   - å®šä¹‰ AST éª¨æ¶æå–æ¨¡å¼

4. **[NEW]** `dev-playbooks/specs/drift-detector/spec.md`
   - æ–°å¢æ¶æ„æ¼‚ç§»æ£€æµ‹èƒ½åŠ›è§„æ ¼
   - å®šä¹‰æ¼‚ç§»è¯„åˆ†ç®—æ³•
   - å®šä¹‰å¿«ç…§ diff ç®—æ³•

5. **[NEW]** `dev-playbooks/specs/benchmark/spec.md`
   - æ–°å¢è¯„æµ‹åŸºå‡†èƒ½åŠ›è§„æ ¼
   - å®šä¹‰ MRR@10ã€P95 å»¶è¿Ÿç­‰æŒ‡æ ‡
   - å®šä¹‰åŸºçº¿å¯¹æ¯”æœºåˆ¶

6. **[EXTEND]** `dev-playbooks/specs/subgraph-retrieval/spec.md`ï¼ˆgraph-rag.shï¼‰
   - æ–°å¢é‡æ’åºç®¡çº¿é›†æˆ
   - æ–°å¢ä¸Šä¸‹æ–‡å±‚ä¿¡å·åŠ æƒ
   - æ–°å¢æ··åˆæ£€ç´¢æ”¯æŒ

7. **[EXTEND]** `dev-playbooks/specs/hotspot-analysis/spec.md`
   - æ–°å¢ Bug ä¿®å¤å†å²æƒé‡
   - æ–°å¢çƒ­ç‚¹ä¼˜å…ˆå‹ç¼©ç­–ç•¥

8. **[EXTEND]** `dev-playbooks/specs/pattern-learning/spec.md`
   - æ–°å¢å¼‚å¸¸æ£€æµ‹ç»“æœè¾“å‡ºåˆ° `anomalies.jsonl`
   - æ–°å¢ä¸ Bug å®šä½çš„åé¦ˆé—­ç¯

**Spec æ›´æ–°è®¡åˆ’**ï¼š
- åœ¨ Design é˜¶æ®µè¡¥å……ä¸Šè¿° Spec çš„ deltaï¼ˆæ–°å¢ REQ/Scenarioï¼‰
- åœ¨ Archive é˜¶æ®µåˆå¹¶ Spec delta åˆ°çœŸç†æº

### ä¾èµ–å…¼å®¹æ€§åˆ†æ

**å¤–éƒ¨ä¾èµ–ï¼ˆæ— æ–°å¢ï¼‰**ï¼š
| ä¾èµ– | å½“å‰ç‰ˆæœ¬ | å…¼å®¹æ€§ | é£é™©è¯„ä¼° |
|------|----------|--------|----------|
| @modelcontextprotocol/sdk | ^1.0.0 | å®Œå…¨å…¼å®¹ | æ— é£é™©ï¼ˆæ— å˜æ›´ï¼‰ |
| ripgrep (rg) | >= 13.0 | å®Œå…¨å…¼å®¹ | æ— é£é™©ï¼ˆæ— å˜æ›´ï¼‰ |
| jq | >= 1.6 | å®Œå…¨å…¼å®¹ | æ— é£é™©ï¼ˆæ— å˜æ›´ï¼‰ |
| SQLite | >= 3.35 | å®Œå…¨å…¼å®¹ | éœ€éªŒè¯é—­åŒ…è¡¨æ€§èƒ½ |
| Node.js | >= 18.0.0 | å®Œå…¨å…¼å®¹ | æ— é£é™©ï¼ˆæ— å˜æ›´ï¼‰ |

**å†…éƒ¨è„šæœ¬ä¾èµ–ï¼ˆæ–°å¢/ä¿®æ”¹ï¼‰**ï¼š
| ä¾èµ–å…³ç³» | ç±»å‹ | å†²çªé£é™© | ç¼“è§£æªæ–½ |
|----------|------|----------|----------|
| context-compressor.sh â†’ hotspot-analyzer.sh | æ–°å¢ | ä½ | hotspot-analyzer.sh å·²å­˜åœ¨ä¸”ç¨³å®š |
| drift-detector.sh â†’ graph-store.sh | æ–°å¢ | ä¸­ | graph-store.sh å°†æ–°å¢é—­åŒ…è¡¨ï¼Œéœ€ç¡®ä¿å‘åå…¼å®¹ |
| call-chain.sh â†’ scip-to-graph.sh | å¢å¼º | ä½ | ä»…æ–°å¢ --data-flow å‚æ•°ï¼Œä¸å½±å“ç°æœ‰åŠŸèƒ½ |
| graph-rag.sh â†’ reranker.sh | æ–°å¢ | ä½ | reranker.sh å·²å­˜åœ¨ï¼Œé€šè¿‡é…ç½®å¼€å…³æ§åˆ¶ |
| graph-rag.sh â†’ context-layer.sh | å¢å¼º | ä½ | context-layer.sh å·²å­˜åœ¨ï¼Œä»…æ–°å¢ä¿¡å·æå– |
| bug-locator.sh â†’ semantic-anomaly.sh | æ–°å¢ | ä¸­ | semantic-anomaly.sh ä¸ºæ–°è„šæœ¬ï¼Œéœ€ç¡®ä¿è¾“å‡ºæ ¼å¼ç¨³å®š |
| pattern-learner.sh â†’ semantic-anomaly.sh | æ–°å¢ | ä¸­ | åŒä¸Š |

**ä¾èµ–å†²çªé£é™©è¯„ä¼°**ï¼š
1. **graph-store.sh é—­åŒ…è¡¨å˜æ›´ï¼ˆä¸­é£é™©ï¼‰**ï¼š
   - **é£é™©**ï¼šæ–°å¢é—­åŒ…è¡¨å¯èƒ½å½±å“ç°æœ‰æŸ¥è¯¢æ€§èƒ½
   - **ç¼“è§£**ï¼šé€šè¿‡é…ç½®å¼€å…³ `graph_acceleration` æ§åˆ¶ï¼Œé»˜è®¤ç¦ç”¨
   - **éªŒè¯**ï¼šè¿è¡Œ `tests/graph-store.bats` ç¡®ä¿å‘åå…¼å®¹

2. **semantic-anomaly.sh è¾“å‡ºæ ¼å¼ï¼ˆä¸­é£é™©ï¼‰**ï¼š
   - **é£é™©**ï¼šæ–°è„šæœ¬è¾“å‡ºæ ¼å¼ä¸ç¨³å®šï¼Œå½±å“ä¸‹æ¸¸è„šæœ¬
   - **ç¼“è§£**ï¼šå®šä¹‰æ˜ç¡®çš„ JSON Schemaï¼Œé€šè¿‡æµ‹è¯•éªŒè¯
   - **éªŒè¯**ï¼šè¿è¡Œ `tests/semantic-anomaly.bats` ç¡®ä¿è¾“å‡ºæ ¼å¼æ­£ç¡®

3. **SQLite ç‰ˆæœ¬å…¼å®¹æ€§ï¼ˆä½é£é™©ï¼‰**ï¼š
   - **é£é™©**ï¼šé—­åŒ…è¡¨ä½¿ç”¨çš„ SQL ç‰¹æ€§å¯èƒ½ä¸å…¼å®¹æ—§ç‰ˆæœ¬ SQLite
   - **ç¼“è§£**ï¼šåœ¨å®‰è£…è„šæœ¬ä¸­æ£€æŸ¥ SQLite ç‰ˆæœ¬ï¼ˆ>= 3.35ï¼‰
   - **éªŒè¯**ï¼šåœ¨ CI ä¸­æµ‹è¯•å¤šä¸ª SQLite ç‰ˆæœ¬

**ä¾èµ–ç‰ˆæœ¬å…¼å®¹æ€§æµ‹è¯•è®¡åˆ’**ï¼š
1. åœ¨ CI ä¸­æµ‹è¯• SQLite 3.35ã€3.40ã€3.43 ä¸‰ä¸ªç‰ˆæœ¬
2. åœ¨ Node.js 18ã€20ã€22 ä¸‰ä¸ªç‰ˆæœ¬ä¸­è¿è¡Œæµ‹è¯•
3. éªŒè¯æ‰€æœ‰å¤–éƒ¨ä¾èµ–çš„æœ€ä½ç‰ˆæœ¬è¦æ±‚

### å…¼å®¹æ€§ä¸é£é™©ï¼ˆCompatibility & Risksï¼‰

**Breaking å˜åŒ–**ï¼š
- **æ— ç ´åæ€§å˜æ›´**ï¼šæ‰€æœ‰æ–°å¢åŠŸèƒ½é€šè¿‡é…ç½®å¼€å…³æ§åˆ¶ï¼Œé»˜è®¤ç¦ç”¨æˆ–å‘åå…¼å®¹

**å…¼å®¹æ€§ä¿è¯**ï¼š
| å±‚é¢ | å…¼å®¹æ€§ | è¯´æ˜ |
|------|--------|------|
| MCP åè®® | å®Œå…¨å…¼å®¹ | ä¸ä¿®æ”¹ MCP å·¥å…·æ¥å£ |
| CLI æ¥å£ | å‘åå…¼å®¹ | ä»…æ–°å¢å¯é€‰å‚æ•°ï¼Œä¸ä¿®æ”¹ç°æœ‰å‚æ•° |
| é…ç½®æ–‡ä»¶ | å‘åå…¼å®¹ | æ–°å¢é…ç½®é¡¹æœ‰é»˜è®¤å€¼ |
| æ•°æ®æ ¼å¼ | å‘åå…¼å®¹ | SQLite Schema è‡ªåŠ¨è¿ç§»ï¼Œæ”¯æŒå›æ»š |
| å¤–éƒ¨ä¾èµ– | å®Œå…¨å…¼å®¹ | æ— æ–°å¢å¤–éƒ¨ä¾èµ– |

**è¿ç§»/å›æ»šè·¯å¾„**ï¼š
1. **æ€§èƒ½å›é€€å›æ»š**ï¼šé€šè¿‡ `config/features.yaml` ç¦ç”¨æ–°åŠŸèƒ½ï¼ˆ< 1 åˆ†é’Ÿï¼‰
2. **æ•°æ®æŸåå›æ»š**ï¼šåˆ é™¤æ–°å¢çš„ SQLite è¡¨ï¼Œé‡å»ºç´¢å¼•ï¼ˆ< 5 åˆ†é’Ÿï¼‰
3. **åŠŸèƒ½å¼‚å¸¸å›æ»š**ï¼šGit revert åˆ°ä¸Šä¸€ç‰ˆæœ¬ï¼ˆ< 10 åˆ†é’Ÿï¼‰

**é™çº§æ–¹æ¡ˆ**ï¼š
æ‰€æœ‰æ–°åŠŸèƒ½é€šè¿‡ `config/features.yaml` é…ç½®å¼€å…³æ§åˆ¶ï¼š
```yaml
features:
  context_compression: true
  drift_detection: true
  data_flow_tracing: true
  graph_acceleration: true
  hybrid_retrieval: true
  reranker: true
  context_signals: true
  anomaly_feedback: true
  benchmark: true
```

### æœ€å°æ”¹åŠ¨é¢ç­–ç•¥ï¼ˆMinimal Diff Strategyï¼‰

**ä¼˜å…ˆæ”¹åŠ¨ç‚¹ï¼ˆ3 ä¸ª"å˜åŒ–æ”¶å£ç‚¹"ï¼‰**ï¼š

1. **å›¾æŸ¥è¯¢åŠ é€Ÿï¼ˆgraph-store.shï¼‰**
   - **æ”¶å£ç‚¹**ï¼šSQLite Schema è¿ç§»é€»è¾‘
   - **å½±å“èŒƒå›´**ï¼šæ‰€æœ‰ä¾èµ–å›¾æŸ¥è¯¢çš„åŠŸèƒ½ï¼ˆæ¼‚ç§»æ£€æµ‹ã€æ··åˆæ£€ç´¢ã€é‡æ’åºï¼‰
   - **æœ€å°åŒ–ç­–ç•¥**ï¼š
     - é€šè¿‡ `graph_acceleration` é…ç½®å¼€å…³æ§åˆ¶
     - è¿ç§»é€»è¾‘ç‹¬ç«‹å°è£…åœ¨ `scripts/migrations/` ç›®å½•
     - å¤±è´¥æ—¶è‡ªåŠ¨å›æ»šåˆ°å¤‡ä»½

2. **æ··åˆæ£€ç´¢ï¼ˆembedding.shï¼‰**
   - **æ”¶å£ç‚¹**ï¼šRRF èåˆç®—æ³•å®ç°
   - **å½±å“èŒƒå›´**ï¼šæ‰€æœ‰ä¾èµ–æ£€ç´¢çš„åŠŸèƒ½ï¼ˆBug å®šä½ã€Graph-RAGï¼‰
   - **æœ€å°åŒ–ç­–ç•¥**ï¼š
     - é€šè¿‡ `hybrid_retrieval` é…ç½®å¼€å…³æ§åˆ¶
     - æƒé‡é…ç½®å¤–éƒ¨åŒ–åˆ° `config/features.yaml`
     - é™çº§åˆ°å•ä¸€å‘é‡æ£€ç´¢ï¼ˆç°æœ‰åŠŸèƒ½ï¼‰

3. **é‡æ’åºç®¡çº¿ï¼ˆgraph-rag.shï¼‰**
   - **æ”¶å£ç‚¹**ï¼šé‡æ’åºç®¡çº¿é›†æˆ
   - **å½±å“èŒƒå›´**ï¼šGraph-RAG ä¸Šä¸‹æ–‡æ£€ç´¢
   - **æœ€å°åŒ–ç­–ç•¥**ï¼š
     - é€šè¿‡ `reranker` é…ç½®å¼€å…³æ§åˆ¶
     - é‡æ’åºé€»è¾‘ç‹¬ç«‹å°è£…åœ¨ `reranker.sh`
     - é™çº§åˆ°æ— é‡æ’åºæ¨¡å¼ï¼ˆç°æœ‰åŠŸèƒ½ï¼‰

**æ˜ç¡®ç¦æ­¢çš„æ”¹åŠ¨ç±»å‹ï¼ˆé¿å…å‘æ•£ï¼‰**ï¼š
- âŒ ç¦æ­¢ä¿®æ”¹ `src/server.ts` çš„ MCP å·¥å…·å®šä¹‰ï¼ˆä¿æŒæ¥å£ç¨³å®šï¼‰
- âŒ ç¦æ­¢å¼•å…¥æ–°çš„å¤–éƒ¨ä¾èµ–ï¼ˆnpm/CLI å·¥å…·ï¼‰
- âŒ ç¦æ­¢ä¿®æ”¹ç°æœ‰è„šæœ¬çš„æ ¸å¿ƒé€»è¾‘ï¼ˆä»…æ–°å¢åŠŸèƒ½ï¼Œä¸é‡æ„ï¼‰
- âŒ ç¦æ­¢è·¨å±‚ä¾èµ–ï¼ˆshared â† core â† integrationï¼‰
- âŒ ç¦æ­¢å¾ªç¯ä¾èµ–ï¼ˆA â†’ B â†’ Aï¼‰

### Pinch Point è¯†åˆ«ä¸æœ€å°æµ‹è¯•é›†

**Pinch Point å®šä¹‰**ï¼šå¤šä¸ªè°ƒç”¨è·¯å¾„æ±‡èšçš„èŠ‚ç‚¹ï¼Œåœ¨æ­¤å¤„å†™æµ‹è¯•å¯è¦†ç›–æ‰€æœ‰ä¸‹æ¸¸è·¯å¾„

**è¯†åˆ«çš„ Pinch Points**ï¼š

1. **[PP-1]** `graph-store.sh::query_graph()`
   - **æ±‡èšè·¯å¾„**ï¼š3 æ¡è°ƒç”¨è·¯å¾„
     - `drift-detector.sh` â†’ `graph-store.sh::query_graph()`ï¼ˆæ¶æ„å¿«ç…§æŸ¥è¯¢ï¼‰
     - `embedding.sh` â†’ `graph-store.sh::query_graph()`ï¼ˆå›¾è·ç¦»è®¡ç®—ï¼‰
     - `graph-rag.sh` â†’ `graph-store.sh::query_graph()`ï¼ˆå­å›¾æ£€ç´¢ï¼‰
   - **æµ‹è¯•ç­–ç•¥**ï¼šåœ¨ `tests/graph-store.bats` ä¸­æµ‹è¯• `query_graph()` å‡½æ•°
   - **è¦†ç›–èŒƒå›´**ï¼šè¦†ç›–æ‰€æœ‰ä¾èµ–å›¾æŸ¥è¯¢çš„åŠŸèƒ½

2. **[PP-2]** `hotspot-analyzer.sh::calculate_score()`
   - **æ±‡èšè·¯å¾„**ï¼š2 æ¡è°ƒç”¨è·¯å¾„
     - `context-compressor.sh` â†’ `hotspot-analyzer.sh::calculate_score()`ï¼ˆçƒ­ç‚¹ä¼˜å…ˆå‹ç¼©ï¼‰
     - `bug-locator.sh` â†’ `hotspot-analyzer.sh::calculate_score()`ï¼ˆçƒ­ç‚¹åŠ æƒï¼‰
   - **æµ‹è¯•ç­–ç•¥**ï¼šåœ¨ `tests/hotspot-analyzer.bats` ä¸­æµ‹è¯• `calculate_score()` å‡½æ•°
   - **è¦†ç›–èŒƒå›´**ï¼šè¦†ç›–æ‰€æœ‰ä¾èµ–çƒ­ç‚¹åˆ†æçš„åŠŸèƒ½

3. **[PP-3]** `embedding.sh::hybrid_search()`
   - **æ±‡èšè·¯å¾„**ï¼š2 æ¡è°ƒç”¨è·¯å¾„
     - `bug-locator.sh` â†’ `embedding.sh::hybrid_search()`ï¼ˆBug å®šä½æ£€ç´¢ï¼‰
     - `graph-rag.sh` â†’ `embedding.sh::hybrid_search()`ï¼ˆGraph-RAG æ£€ç´¢ï¼‰
   - **æµ‹è¯•ç­–ç•¥**ï¼šåœ¨ `tests/embedding.bats` ä¸­æµ‹è¯• `hybrid_search()` å‡½æ•°
   - **è¦†ç›–èŒƒå›´**ï¼šè¦†ç›–æ‰€æœ‰ä¾èµ–æ··åˆæ£€ç´¢çš„åŠŸèƒ½

**æœ€å°æµ‹è¯•é›†**ï¼š
- åœ¨ PP-1 å†™ 1 ä¸ªæµ‹è¯• â†’ è¦†ç›– drift-detector/embedding/graph-rag ä¸‰æ¡è·¯å¾„
- åœ¨ PP-2 å†™ 1 ä¸ªæµ‹è¯• â†’ è¦†ç›– context-compressor/bug-locator ä¸¤æ¡è·¯å¾„
- åœ¨ PP-3 å†™ 1 ä¸ªæµ‹è¯• â†’ è¦†ç›– bug-locator/graph-rag ä¸¤æ¡è·¯å¾„
- **é¢„è®¡æµ‹è¯•æ•°é‡**ï¼š3 ä¸ª Pinch Point æµ‹è¯•ï¼ˆè€Œéä¸ºæ¯æ¡è·¯å¾„å†™ 7 ä¸ªæµ‹è¯•ï¼‰

**ROI åŸåˆ™**ï¼šæµ‹è¯•æ•°é‡ = Pinch Point æ•°é‡ï¼ˆ3 ä¸ªï¼‰ï¼Œè€Œéè°ƒç”¨è·¯å¾„æ•°é‡ï¼ˆ7 ä¸ªï¼‰

### éœ€è¦è¡¥é½çš„èµ„æ–™ï¼ˆOpen Questionsï¼‰

1. **å‹ç¼©ç®—æ³•é€‰æ‹©ï¼ˆDP-02ï¼‰**
   - **é—®é¢˜**ï¼šAST éª¨æ¶æŠ½å– vs æ­£åˆ™è¿‡æ»¤ vs LLM æ‘˜è¦ï¼Œå“ªç§ç®—æ³•æœ€ä¼˜ï¼Ÿ
   - **å½±å“**ï¼šå‹ç¼©ç‡å’Œä¿¡æ¯ä¿ç•™ç‡
   - **å†³ç­–æˆªæ­¢**ï¼šDesign é˜¶æ®µå‰ï¼ˆå·²åœ¨ Debate Packet ä¸­æå‡ºï¼‰

2. **å›¾æŸ¥è¯¢åŠ é€Ÿç­–ç•¥ï¼ˆDP-04ï¼‰**
   - **é—®é¢˜**ï¼šé—­åŒ…è¡¨ vs è·¯å¾„ç´¢å¼• vs ç¼“å­˜ + æ‡’åŠ è½½ï¼Œå“ªç§ç­–ç•¥æœ€ä¼˜ï¼Ÿ
   - **å½±å“**ï¼šæŸ¥è¯¢æ€§èƒ½å’Œå­˜å‚¨ç©ºé—´
   - **å†³ç­–æˆªæ­¢**ï¼šDesign é˜¶æ®µå‰ï¼ˆå·²åœ¨ Debate Packet ä¸­æå‡ºï¼‰

3. **æ··åˆæ£€ç´¢æƒé‡é…ç½®ï¼ˆDP-03ï¼‰**
   - **é—®é¢˜**ï¼šå›ºå®šæƒé‡ vs è‡ªé€‚åº”æƒé‡ vs ç”¨æˆ·å¯é…ç½®æƒé‡ï¼Œå“ªç§æ–¹æ¡ˆæœ€ä¼˜ï¼Ÿ
   - **å½±å“**ï¼šæ£€ç´¢è´¨é‡å’Œçµæ´»æ€§
   - **å†³ç­–æˆªæ­¢**ï¼šDesign é˜¶æ®µå‰ï¼ˆå·²åœ¨ Debate Packet ä¸­æå‡ºï¼‰

---

| ä¿¡å· | å½“å‰å€¼ | ç›®æ ‡å€¼ | æµ‹é‡æ–¹å¼ | åŸºçº¿æµ‹é‡ç¯å¢ƒ |
|------|--------|--------|----------|--------------|
| æ£€ç´¢è´¨é‡ï¼ˆMRR@10ï¼‰ | 0.54ï¼ˆåŸºäºæœ¬é¡¹ç›® 32 ä¸ªè„šæœ¬çš„è¯­ä¹‰æœç´¢æµ‹è¯•ï¼‰ | > 0.69 | benchmark.sh | æœ¬åœ° MacBook Pro M1, 32 ä¸ªè„šæœ¬æ–‡ä»¶ï¼Œ10 ä¸ªæŸ¥è¯¢æ ·æœ¬ |
| å›¾æŸ¥è¯¢å»¶è¿Ÿï¼ˆP95ï¼‰ | 1200msï¼ˆåŸºäº graph-store.sh çš„ 3 è·³æŸ¥è¯¢ï¼‰ | < 200ms | benchmark.sh | SQLite 3.43.0, æ— ç´¢å¼•ä¼˜åŒ–ï¼Œæµ‹è¯•æ•°æ®ï¼š500 ä¸ªç¬¦å·èŠ‚ç‚¹ |
| ä¸Šä¸‹æ–‡å‹ç¼©ç‡ | 0%ï¼ˆå½“å‰æ— å‹ç¼©æœºåˆ¶ï¼‰ | > 60% | benchmark.sh | N/Aï¼ˆæ–°åŠŸèƒ½ï¼‰ |
| æ¶æ„æ¼‚ç§»æ£€æµ‹å‡†ç¡®ç‡ | N/Aï¼ˆæ–°åŠŸèƒ½ï¼‰ | > 90% | äººå·¥æ ‡æ³¨ + è‡ªåŠ¨éªŒè¯ | N/Aï¼ˆæ–°åŠŸèƒ½ï¼‰ |

**åŸºçº¿æµ‹é‡æ–¹æ³•**ï¼š
- **æ£€ç´¢è´¨é‡**ï¼šä½¿ç”¨ `scripts/embedding.sh` å¯¹æœ¬é¡¹ç›® 32 ä¸ªè„šæœ¬è¿›è¡Œè¯­ä¹‰æœç´¢ï¼Œ10 ä¸ªæŸ¥è¯¢æ ·æœ¬ï¼ˆå¦‚ "graph query", "bug locate", "complexity analysis"ï¼‰ï¼Œè®¡ç®— MRR@10
- **å›¾æŸ¥è¯¢å»¶è¿Ÿ**ï¼šä½¿ç”¨ `scripts/graph-store.sh` æ‰§è¡Œ 3 è·³è°ƒç”¨é“¾æŸ¥è¯¢ï¼ˆ`ci_call_chain --depth 3`ï¼‰ï¼Œæµ‹é‡ P95 å»¶è¿Ÿ
- **å‹ç¼©ç‡å’Œæ¼‚ç§»æ£€æµ‹**ï¼šæ–°åŠŸèƒ½ï¼Œæ— åŸºçº¿æ•°æ®

**è¯æ®è½ç‚¹**ï¼š`evidence/baseline-metrics.json`ï¼ˆåŒ…å«åŸå§‹æµ‹é‡æ•°æ®å’Œæµ‹è¯•è„šæœ¬ï¼‰

### ä»·å€¼æµç“¶é¢ˆå‡è®¾

**å‡è®¾ 1**ï¼šä¸Šä¸‹æ–‡çˆ†ç‚¸æ˜¯ LLM äº¤äº’çš„ä¸»è¦ç“¶é¢ˆ
- **éªŒè¯æ–¹å¼**ï¼šç»Ÿè®¡å‹ç¼©å‰å token æ•°é‡ï¼Œæµ‹é‡ LLM å“åº”æ—¶é—´
- **å¤±è´¥æ¡ä»¶**ï¼šå‹ç¼©ç‡ < 50% æˆ–ä¿¡æ¯ä¿ç•™ç‡ < 80%

**å‡è®¾ 2**ï¼šæ··åˆæ£€ç´¢æ¯”å•ä¸€å‘é‡æ£€ç´¢æ•ˆæœæ›´å¥½
- **éªŒè¯æ–¹å¼**ï¼šA/B æµ‹è¯•ï¼Œå¯¹æ¯” MRR@10 æŒ‡æ ‡
- **å¤±è´¥æ¡ä»¶**ï¼šMRR@10 æå‡ < 10%

**å‡è®¾ 3**ï¼šå›¾æŸ¥è¯¢åŠ é€Ÿèƒ½æ˜¾è‘—æå‡äº¤äº’ä½“éªŒ
- **éªŒè¯æ–¹å¼**ï¼šæµ‹é‡ P95 å»¶è¿Ÿï¼Œç”¨æˆ·åé¦ˆ
- **å¤±è´¥æ¡ä»¶**ï¼šP95 å»¶è¿Ÿä¸‹é™ < 50%

---

## Risks & Rollbackï¼ˆé£é™©ä¸å›æ»šï¼‰

### é£é™©æ¸…å•

| é£é™© ID | æè¿° | æ¦‚ç‡ | å½±å“ | ç¼“è§£æªæ–½ |
|---------|------|------|------|----------|
| R-01 | é—­åŒ…è¡¨è®¡ç®—è€—æ—¶è¿‡é•¿ï¼Œå½±å“å¯åŠ¨é€Ÿåº¦ | ä¸­ | ä¸­ | å¼‚æ­¥é¢„è®¡ç®— + å¢é‡æ›´æ–° |
| R-02 | å‹ç¼©ç®—æ³•ä¿¡æ¯ä¸¢å¤±è¿‡å¤šï¼Œå½±å“ LLM ç†è§£ | ä¸­ | é«˜ | æä¾›å‹ç¼©çº§åˆ«é…ç½®ï¼ˆaggressive/balanced/conservativeï¼‰ |
| R-03 | æ··åˆæ£€ç´¢æƒé‡è°ƒä¼˜å›°éš¾ï¼Œæ•ˆæœä¸ç¨³å®š | é«˜ | ä¸­ | æä¾›æƒé‡é…ç½® + A/B æµ‹è¯•æ¡†æ¶ |
| R-04 | æ•°æ®æµè¿½è¸ªè¦†ç›–ç‡ä¸è¶³ï¼ˆä»…æ”¯æŒ TS/JSï¼‰ | ä½ | ä½ | æ–‡æ¡£è¯´æ˜é™åˆ¶ï¼Œåç»­æ‰©å±•å…¶ä»–è¯­è¨€ |
| R-05 | æ¼‚ç§»æ£€æµ‹è¯¯æŠ¥ç‡é«˜ï¼Œå¹²æ‰°å¼€å‘æµç¨‹ | ä¸­ | ä¸­ | æä¾›é˜ˆå€¼é…ç½® + ç™½åå•æœºåˆ¶ |
| R-06 | 9 ä¸ªåŠŸèƒ½ç‚¹é›†æˆå¤æ‚åº¦é«˜ï¼Œæµ‹è¯•ä¸å……åˆ† | é«˜ | é«˜ | åˆ†é˜¶æ®µé›†æˆ + å……åˆ†æµ‹è¯• + åŠŸèƒ½å¼€å…³ |

### å›æ»šç­–ç•¥

| åœºæ™¯ | å›æ»šæ–¹å¼ | æ¢å¤æ—¶é—´ |
|------|----------|----------|
| æ€§èƒ½å›é€€ | é€šè¿‡ config/features.yaml ç¦ç”¨æ–°åŠŸèƒ½ | < 1 åˆ†é’Ÿ |
| æ•°æ®æŸå | åˆ é™¤æ–°å¢çš„ SQLite è¡¨ï¼Œé‡å»ºç´¢å¼• | < 5 åˆ†é’Ÿ |
| åŠŸèƒ½å¼‚å¸¸ | Git revert åˆ°ä¸Šä¸€ç‰ˆæœ¬ | < 10 åˆ†é’Ÿ |

### é™çº§æ–¹æ¡ˆ

æ‰€æœ‰æ–°åŠŸèƒ½é€šè¿‡ `config/features.yaml` é…ç½®å¼€å…³æ§åˆ¶ï¼š
```yaml
features:
  context_compression: true
  drift_detection: true
  data_flow_tracing: true
  graph_acceleration: true
  hybrid_retrieval: true
  reranker: true
  context_signals: true
  anomaly_feedback: true
  benchmark: true
```

**é™çº§æ­¥éª¤**ï¼š
1. å°†å¯¹åº”åŠŸèƒ½å¼€å…³è®¾ä¸º `false`
2. é‡å¯ MCP Serverï¼ˆå¦‚éœ€è¦ï¼‰
3. éªŒè¯åŠŸèƒ½å·²ç¦ç”¨

### å›æ»šéªŒè¯æµ‹è¯•

**åœºæ™¯ 1ï¼šæ€§èƒ½å›é€€å›æ»š**
- **è§¦å‘æ¡ä»¶**ï¼šbenchmark.sh æ˜¾ç¤º P95 å»¶è¿Ÿ > åŸºçº¿ Ã— 1.5
- **å›æ»šæ­¥éª¤**ï¼š
  1. ç¼–è¾‘ `config/features.yaml`ï¼Œè®¾ç½® `graph_acceleration: false`
  2. é‡å¯ MCP Serverï¼š`pkill -f "node.*server.ts" && npm start`
  3. è¿è¡Œ `npm test -- tests/graph-store.bats`
- **éªŒè¯æ­¥éª¤**ï¼š
  1. è¿è¡Œ `scripts/benchmark.sh --metric graph_query_latency`
  2. æ£€æŸ¥ P95 å»¶è¿Ÿæ˜¯å¦æ¢å¤åˆ°åŸºçº¿æ°´å¹³ï¼ˆ< 1200ms Ã— 1.1ï¼‰
  3. æ£€æŸ¥ `evidence/rollback-validation.log` ä¸­çš„å»¶è¿Ÿæ•°æ®
- **é¢„æœŸç»“æœ**ï¼šP95 å»¶è¿Ÿ < 1320msï¼Œæµ‹è¯•é€šè¿‡
- **è¯æ®è½ç‚¹**ï¼š`evidence/rollback-validation.log`

**åœºæ™¯ 2ï¼šæ•°æ®æŸåå›æ»š**
- **è§¦å‘æ¡ä»¶**ï¼šSQLite é—­åŒ…è¡¨æŸåï¼ŒæŸ¥è¯¢è¿”å›é”™è¯¯
- **å›æ»šæ­¥éª¤**ï¼š
  1. åœæ­¢ MCP Server
  2. åˆ é™¤é—­åŒ…è¡¨ï¼š`sqlite3 .devbooks/graph.db "DROP TABLE IF EXISTS closure_table; DROP TABLE IF EXISTS path_index;"`
  3. é‡å»ºç´¢å¼•ï¼š`scripts/graph-store.sh --rebuild`
  4. é‡å¯ MCP Server
- **éªŒè¯æ­¥éª¤**ï¼š
  1. è¿è¡Œ `scripts/call-chain.sh --symbol main --depth 3`
  2. æ£€æŸ¥è¾“å‡ºæ˜¯å¦æ­£å¸¸ï¼ˆæ—  SQL é”™è¯¯ï¼‰
  3. è¿è¡Œ `npm test -- tests/graph-store.bats`
- **é¢„æœŸç»“æœ**ï¼šè°ƒç”¨é“¾æŸ¥è¯¢æ­£å¸¸ï¼Œæµ‹è¯•é€šè¿‡
- **è¯æ®è½ç‚¹**ï¼š`evidence/rollback-validation.log`

**åœºæ™¯ 3ï¼šåŠŸèƒ½å¼‚å¸¸å›æ»š**
- **è§¦å‘æ¡ä»¶**ï¼šå‹ç¼©ç®—æ³•å¯¼è‡´ä¿¡æ¯ä¸¢å¤±ï¼ŒLLM ç†è§£é”™è¯¯
- **å›æ»šæ­¥éª¤**ï¼š
  1. Git revert åˆ°ä¸Šä¸€ç‰ˆæœ¬ï¼š`git revert HEAD`
  2. é‡æ–°å®‰è£…ï¼š`npm install`
  3. é‡å¯ MCP Server
- **éªŒè¯æ­¥éª¤**ï¼š
  1. è¿è¡Œå®Œæ•´æµ‹è¯•å¥—ä»¶ï¼š`npm test`
  2. æ£€æŸ¥æ‰€æœ‰æµ‹è¯•æ˜¯å¦é€šè¿‡
  3. è¿è¡Œ `scripts/benchmark.sh --full`
- **é¢„æœŸç»“æœ**ï¼šæ‰€æœ‰æµ‹è¯•é€šè¿‡ï¼ŒæŒ‡æ ‡æ¢å¤åˆ°åŸºçº¿
- **æ¢å¤æ—¶é—´**ï¼š< 10 åˆ†é’Ÿ
- **è¯æ®è½ç‚¹**ï¼š`evidence/rollback-validation.log`

**å›æ»šéªŒè¯è‡ªåŠ¨åŒ–è„šæœ¬**ï¼š
```bash
# scripts/validate-rollback.sh
#!/bin/bash
set -euo pipefail

echo "=== å›æ»šéªŒè¯æµ‹è¯• ==="
echo "åœºæ™¯ 1: æ€§èƒ½å›é€€å›æ»š"
# ç¦ç”¨å›¾åŠ é€Ÿ
sed -i.bak 's/graph_acceleration: true/graph_acceleration: false/' config/features.yaml
npm start &
sleep 5
scripts/benchmark.sh --metric graph_query_latency > evidence/rollback-validation.log
pkill -f "node.*server.ts"

echo "åœºæ™¯ 2: æ•°æ®æŸåå›æ»š"
sqlite3 .devbooks/graph.db "DROP TABLE IF EXISTS closure_table;"
scripts/graph-store.sh --rebuild
npm test -- tests/graph-store.bats >> evidence/rollback-validation.log

echo "åœºæ™¯ 3: åŠŸèƒ½å¼‚å¸¸å›æ»š"
git stash
git revert HEAD --no-commit
npm install
npm test >> evidence/rollback-validation.log
git reset --hard HEAD
git stash pop

echo "=== å›æ»šéªŒè¯å®Œæˆ ==="
```

---

## Validationï¼ˆå€™é€‰éªŒæ”¶é”šç‚¹ + è¯æ®è½ç‚¹ï¼‰

### éªŒæ”¶æ ‡å‡†

| AC-ID | æè¿° | éªŒè¯æ–¹å¼ | è¯æ®è½ç‚¹ |
|-------|------|----------|----------|
| AC-001 | ä¸Šä¸‹æ–‡å‹ç¼©ç‡ > 60%ï¼Œä¿¡æ¯ä¿ç•™ç‡ > 85% | è¿è¡Œ benchmark.shï¼Œæ£€æŸ¥å‹ç¼©æŒ‡æ ‡ | `evidence/compression-metrics.json` |
| AC-002 | æ¶æ„æ¼‚ç§»æ£€æµ‹å‡†ç¡®ç‡ > 90% | äººå·¥æ ‡æ³¨ 10 ä¸ªæ¼‚ç§»æ¡ˆä¾‹ï¼Œè¿è¡Œ drift-detector.sh | `evidence/drift-detection-accuracy.json` |
| AC-003 | æ•°æ®æµè¿½è¸ªè¦†ç›– TS/JSï¼Œè¾“å‡ºæ ¼å¼æ­£ç¡® | è¿è¡Œ tests/data-flow-tracing.bats | Bats æµ‹è¯•æŠ¥å‘Š |
| AC-004 | å›¾æŸ¥è¯¢ P95 < 200ms | è¿è¡Œ benchmark.shï¼Œæ£€æŸ¥å»¶è¿ŸæŒ‡æ ‡ | `evidence/graph-query-latency.json` |
| AC-005 | æ··åˆæ£€ç´¢ MRR@10 æå‡ > 15% | è¿è¡Œ benchmark.shï¼Œå¯¹æ¯”åŸºçº¿ | `evidence/retrieval-quality.json` |
| AC-006 | é‡æ’åºç®¡çº¿é»˜è®¤å¯ç”¨ï¼Œå¯é…ç½®å…³é—­ | æ£€æŸ¥ config/features.yamlï¼Œè¿è¡Œé›†æˆæµ‹è¯• | `evidence/reranker-integration.log` |
| AC-007 | ä¸Šä¸‹æ–‡å±‚ä¿¡å·æ­£ç¡®çº³å…¥æ£€ç´¢æƒé‡ | è¿è¡Œ graph-rag.shï¼Œæ£€æŸ¥ priority score è®¡ç®— | `evidence/context-signals.log` |
| AC-008 | å¼‚å¸¸æ£€æµ‹ç»“æœè¿›å…¥ Bug å®šä½é“¾è·¯ | è¿è¡Œ bug-locator.shï¼Œæ£€æŸ¥å¼‚å¸¸æ–‡ä»¶ä¼˜å…ˆçº§ | `evidence/anomaly-feedback.log` |
| AC-009 | benchmark.sh è¾“å‡ºå®Œæ•´æŒ‡æ ‡æŠ¥å‘Š | è¿è¡Œ benchmark.shï¼Œæ£€æŸ¥è¾“å‡ºæ ¼å¼ | `evidence/benchmark-report.md` |
| AC-010 | æ‰€æœ‰æ–°å¢æµ‹è¯•é€šè¿‡ | è¿è¡Œ npm test | Bats æµ‹è¯•æŠ¥å‘Š |
| AC-011 | æ— æ€§èƒ½å›é€€ï¼ˆç°æœ‰åŠŸèƒ½å»¶è¿Ÿ < åŸºçº¿ Ã— 1.1ï¼‰ | è¿è¡Œ benchmark.shï¼Œå¯¹æ¯”åŸºçº¿ | `evidence/performance-regression.json` |
| AC-012 | åŠŸèƒ½å¼€å…³æ­£ç¡®æ§åˆ¶æ‰€æœ‰æ–°åŠŸèƒ½ | é€ä¸ªå…³é—­å¼€å…³ï¼ŒéªŒè¯åŠŸèƒ½ç¦ç”¨ | `evidence/feature-toggle-test.log` |

### æµ‹è¯•æ–‡ä»¶æ¸…å•

**æ–°å¢æµ‹è¯•æ–‡ä»¶ï¼ˆ4 ä¸ªï¼‰**ï¼š
1. `tests/context-compressor.bats` - ä¸Šä¸‹æ–‡å‹ç¼©åŠŸèƒ½æµ‹è¯•
2. `tests/drift-detector.bats` - æ¶æ„æ¼‚ç§»æ£€æµ‹æµ‹è¯•
3. `tests/data-flow-tracing.bats` - æ•°æ®æµè¿½è¸ªæµ‹è¯•ï¼ˆå·²å­˜åœ¨ï¼Œéœ€å¢å¼ºï¼‰
4. `tests/benchmark.bats` - è¯„æµ‹åŸºå‡†æµ‹è¯•

**ä¿®æ”¹æµ‹è¯•æ–‡ä»¶ï¼ˆ3 ä¸ªï¼‰**ï¼š
1. `tests/graph-store.bats` - å¢åŠ é—­åŒ…è¡¨å’Œè·¯å¾„ç´¢å¼•æµ‹è¯•
2. `tests/embedding.bats` - å¢åŠ æ··åˆæ£€ç´¢æµ‹è¯•
3. `tests/graph-rag.bats` - å¢åŠ é‡æ’åºå’Œä¸Šä¸‹æ–‡ä¿¡å·æµ‹è¯•

**æ€»è®¡**ï¼š4 ä¸ªæ–°å¢ + 3 ä¸ªä¿®æ”¹ = 7 ä¸ªæµ‹è¯•æ–‡ä»¶

### é›†æˆæµ‹è¯•çŸ©é˜µ

| åŠŸèƒ½ç‚¹ | ä¾èµ–åŠŸèƒ½ | é›†æˆæµ‹è¯•åœºæ™¯ | æµ‹è¯•æ–‡ä»¶ |
|--------|----------|--------------|----------|
| ä¸Šä¸‹æ–‡å‹ç¼© | hotspot-analyzer.sh | å‹ç¼© + çƒ­ç‚¹ä¼˜å…ˆç­–ç•¥ | context-compressor.bats |
| æ¶æ„æ¼‚ç§»æ£€æµ‹ | graph-store.sh | æ¼‚ç§»æ£€æµ‹ + å›¾å­˜å‚¨ | drift-detector.bats |
| æ•°æ®æµè¿½è¸ª | call-chain.sh, scip-to-graph.sh | æ•°æ®æµ + è°ƒç”¨é“¾ | data-flow-tracing.bats |
| å›¾æŸ¥è¯¢åŠ é€Ÿ | graph-store.sh | é—­åŒ…è¡¨ + è·¯å¾„ç´¢å¼• | graph-store.bats |
| æ··åˆæ£€ç´¢ | embedding.sh, graph-store.sh | å…³é”®è¯ + å‘é‡ + å›¾è·ç¦» | embedding.bats |
| é‡æ’åºç®¡çº¿ | graph-rag.sh, reranker.sh | Graph-RAG + é‡æ’åº | graph-rag.bats |
| ä¸Šä¸‹æ–‡å±‚ä¿¡å· | context-layer.sh, graph-rag.sh | ä¿¡å·æå– + æƒé‡è®¡ç®— | graph-rag.bats |
| å¼‚å¸¸æ£€æµ‹é—­ç¯ | semantic-anomaly.sh, bug-locator.sh | å¼‚å¸¸æ£€æµ‹ + Bug å®šä½ | semantic-anomaly.bats |
| è¯„æµ‹åŸºå‡† | æ‰€æœ‰åŠŸèƒ½è„šæœ¬ | ç«¯åˆ°ç«¯å›å½’æµ‹è¯• | benchmark.bats |

**æµ‹è¯•è¦†ç›–èŒƒå›´**ï¼š
- **å•å…ƒæµ‹è¯•**ï¼šæ¯ä¸ªæ–°å¢/ä¿®æ”¹è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½ï¼ˆå¦‚å‹ç¼©ç®—æ³•ã€æ¼‚ç§»è¯„åˆ†ã€RRF èåˆï¼‰
- **é›†æˆæµ‹è¯•**ï¼šåŠŸèƒ½ç‚¹ä¹‹é—´çš„ä¾èµ–å…³ç³»ï¼ˆå¦‚å‹ç¼© + çƒ­ç‚¹ã€æ¼‚ç§» + å›¾å­˜å‚¨ï¼‰
- **æ€§èƒ½æµ‹è¯•**ï¼šP95 å»¶è¿Ÿã€MRR@10ã€å‹ç¼©ç‡ç­‰æŒ‡æ ‡ï¼ˆé›†æˆåˆ° benchmark.shï¼‰

### è¾¹ç•Œåœºæ™¯

| åŠŸèƒ½ç‚¹ | è¾¹ç•Œåœºæ™¯ | æµ‹è¯•æ–¹æ³• | é¢„æœŸç»“æœ |
|--------|----------|----------|----------|
| ä¸Šä¸‹æ–‡å‹ç¼© | ç©ºæ–‡ä»¶è¾“å…¥ | è¿è¡Œ context-compressor.sh å¤„ç†ç©ºæ–‡ä»¶ | è¿”å›ç©ºç»“æœï¼Œä¸å´©æºƒ |
| ä¸Šä¸‹æ–‡å‹ç¼© | è¶…å¤§æ–‡ä»¶ï¼ˆ> 10MBï¼‰ | å¤„ç† 10MB+ çš„å•ä¸ªæ–‡ä»¶ | å‹ç¼©ç‡ > 60%ï¼Œè€—æ—¶ < 5s |
| ä¸Šä¸‹æ–‡å‹ç¼© | æ— çƒ­ç‚¹æ•°æ® | hotspot-analyzer.sh è¿”å›ç©º | ä½¿ç”¨é»˜è®¤å‹ç¼©ç­–ç•¥ |
| æ¶æ„æ¼‚ç§»æ£€æµ‹ | é¦–æ¬¡è¿è¡Œï¼ˆæ— å¿«ç…§ï¼‰ | è¿è¡Œ drift-detector.sh | ç”Ÿæˆåˆå§‹å¿«ç…§ï¼Œæ¼‚ç§»è¯„åˆ† = 0 |
| æ¶æ„æ¼‚ç§»æ£€æµ‹ | æ— å˜æ›´ | è¿ç»­è¿è¡Œä¸¤æ¬¡ | æ¼‚ç§»è¯„åˆ† = 0 |
| æ¶æ„æ¼‚ç§»æ£€æµ‹ | æç«¯æ¼‚ç§»ï¼ˆ100% å˜æ›´ï¼‰ | åˆ é™¤æ‰€æœ‰æ¨¡å—åé‡å»º | æ¼‚ç§»è¯„åˆ† = 100 |
| æ•°æ®æµè¿½è¸ª | å¾ªç¯å¼•ç”¨ | è¿½è¸ªé€’å½’å‡½æ•° | æ£€æµ‹å¾ªç¯ï¼Œç»ˆæ­¢è¿½è¸ª |
| æ•°æ®æµè¿½è¸ª | æ·±åº¦è¶…é™ï¼ˆ> 10 è·³ï¼‰ | è®¾ç½® --depth 20 | é™åˆ¶ä¸ºæœ€å¤§æ·±åº¦ 10 |
| æ•°æ®æµè¿½è¸ª | é TS/JS æ–‡ä»¶ | è¿½è¸ª Python æ–‡ä»¶ | è¿”å›é”™è¯¯æç¤ºä¸æ”¯æŒ |
| å›¾æŸ¥è¯¢åŠ é€Ÿ | ç©ºå›¾ | æŸ¥è¯¢ä¸å­˜åœ¨çš„ç¬¦å· | è¿”å›ç©ºç»“æœï¼Œä¸å´©æºƒ |
| å›¾æŸ¥è¯¢åŠ é€Ÿ | è¶…å¤§å›¾ï¼ˆ> 10000 èŠ‚ç‚¹ï¼‰ | æŸ¥è¯¢ 10000+ èŠ‚ç‚¹çš„å›¾ | P95 å»¶è¿Ÿ < 200ms |
| å›¾æŸ¥è¯¢åŠ é€Ÿ | å¹¶å‘æŸ¥è¯¢ | 10 ä¸ªå¹¶å‘æŸ¥è¯¢ | æ— æ­»é”ï¼Œç»“æœæ­£ç¡® |
| æ··åˆæ£€ç´¢ | æ— å‘é‡æ•°æ® | embedding.sh æœªåˆå§‹åŒ– | é™çº§ä¸ºå…³é”®è¯æ£€ç´¢ |
| æ··åˆæ£€ç´¢ | æ— å›¾æ•°æ® | graph-store.sh æœªåˆå§‹åŒ– | é™çº§ä¸ºå‘é‡æ£€ç´¢ |
| æ··åˆæ£€ç´¢ | ç©ºæŸ¥è¯¢ | æŸ¥è¯¢å­—ç¬¦ä¸²ä¸ºç©º | è¿”å›ç©ºç»“æœ |
| é‡æ’åºç®¡çº¿ | reranker ç¦ç”¨ | config/features.yaml ä¸­ reranker: false | è·³è¿‡é‡æ’åºï¼Œç›´æ¥è¿”å› |
| é‡æ’åºç®¡çº¿ | LLM è¶…æ—¶ | reranker.sh è¶…æ—¶ | é™çº§ä¸º heuristic rerank |
| ä¸Šä¸‹æ–‡å±‚ä¿¡å· | æ— å†å²æ•°æ® | é¦–æ¬¡è¿è¡Œ | ä½¿ç”¨é»˜è®¤æƒé‡ |
| å¼‚å¸¸æ£€æµ‹é—­ç¯ | æ— å­¦ä¹ æ¨¡å¼ | pattern-learner.sh æœªè¿è¡Œ | è¿”å›ç©ºå¼‚å¸¸åˆ—è¡¨ |
| å¼‚å¸¸æ£€æµ‹é—­ç¯ | è¯¯æŠ¥ç‡é«˜ | ç½®ä¿¡åº¦é˜ˆå€¼è¿‡ä½ | é€šè¿‡é…ç½®è°ƒæ•´é˜ˆå€¼ |
| è¯„æµ‹åŸºå‡† | æ— åŸºçº¿æ•°æ® | é¦–æ¬¡è¿è¡Œ benchmark.sh | ç”ŸæˆåŸºçº¿ï¼Œæ— å¯¹æ¯” |

### æ€§èƒ½å›é€€æ£€æµ‹

**æ£€æµ‹æ–¹æ¡ˆ**ï¼š
1. **åŸºçº¿å»ºç«‹**ï¼š
   - åœ¨å˜æ›´å‰è¿è¡Œ `scripts/benchmark.sh --baseline`
   - ä¿å­˜åŸºçº¿æ•°æ®åˆ° `evidence/baseline-metrics.json`
   - åŸºçº¿åŒ…å«ï¼šP95 å»¶è¿Ÿã€MRR@10ã€å†…å­˜ä½¿ç”¨ã€CPU ä½¿ç”¨

2. **å›é€€æ£€æµ‹é˜ˆå€¼**ï¼š
   - **P95 å»¶è¿Ÿ**ï¼šä¸å¾—è¶…è¿‡åŸºçº¿ Ã— 1.1ï¼ˆ10% å®¹å¿åº¦ï¼‰
   - **MRR@10**ï¼šä¸å¾—ä½äºåŸºçº¿ Ã— 0.95ï¼ˆ5% å®¹å¿åº¦ï¼‰
   - **å†…å­˜ä½¿ç”¨**ï¼šä¸å¾—è¶…è¿‡åŸºçº¿ Ã— 1.2ï¼ˆ20% å®¹å¿åº¦ï¼‰
   - **CPU ä½¿ç”¨**ï¼šä¸å¾—è¶…è¿‡åŸºçº¿ Ã— 1.2ï¼ˆ20% å®¹å¿åº¦ï¼‰

3. **æ£€æµ‹æ–¹æ³•**ï¼š
   - åœ¨å˜æ›´åè¿è¡Œ `scripts/benchmark.sh --compare evidence/baseline-metrics.json`
   - è‡ªåŠ¨å¯¹æ¯”å½“å‰æŒ‡æ ‡ä¸åŸºçº¿
   - è¾“å‡ºå›é€€æŠ¥å‘Šåˆ° `evidence/performance-regression.json`

4. **å‘Šè­¦æœºåˆ¶**ï¼š
   - å¦‚æœä»»ä½•æŒ‡æ ‡è¶…è¿‡é˜ˆå€¼ï¼Œbenchmark.sh è¿”å›éé›¶é€€å‡ºç 
   - åœ¨ CI ä¸­é›†æˆï¼Œé˜»æ­¢åˆå¹¶
   - è¾“å‡ºè¯¦ç»†çš„å›é€€åˆ†ææŠ¥å‘Š

5. **AC-011 æ‰©å±•**ï¼š
   - **éªŒè¯æ­¥éª¤**ï¼š
     1. è¿è¡Œ `scripts/benchmark.sh --baseline` ä¿å­˜åŸºçº¿
     2. åº”ç”¨å˜æ›´
     3. è¿è¡Œ `scripts/benchmark.sh --compare evidence/baseline-metrics.json`
     4. æ£€æŸ¥é€€å‡ºç å’Œå›é€€æŠ¥å‘Š
   - **é¢„æœŸç»“æœ**ï¼š
     - é€€å‡ºç  = 0ï¼ˆæ— å›é€€ï¼‰
     - æ‰€æœ‰æŒ‡æ ‡åœ¨é˜ˆå€¼èŒƒå›´å†…
     - æŠ¥å‘Šæ˜¾ç¤º "No performance regression detected"
   - **è¯æ®è½ç‚¹**ï¼š`evidence/performance-regression.json`

**æ£€æµ‹è„šæœ¬ç¤ºä¾‹**ï¼š
```bash
# scripts/benchmark.sh --compare åŠŸèƒ½
compare_with_baseline() {
  local baseline_file=$1
  local current_metrics=$(collect_metrics)
  local baseline_metrics=$(cat "$baseline_file")

  # å¯¹æ¯” P95 å»¶è¿Ÿ
  local current_p95=$(echo "$current_metrics" | jq '.graph_query_p95')
  local baseline_p95=$(echo "$baseline_metrics" | jq '.graph_query_p95')
  local threshold=$(echo "$baseline_p95 * 1.1" | bc)

  if (( $(echo "$current_p95 > $threshold" | bc -l) )); then
    echo "ERROR: P95 å»¶è¿Ÿå›é€€ï¼š$current_p95 > $threshold"
    exit 1
  fi

  # å¯¹æ¯” MRR@10
  # ... ç±»ä¼¼é€»è¾‘

  echo "No performance regression detected"
  exit 0
}
```

### è¯æ®æ”¶é›†è®¡åˆ’

1. **è‡ªåŠ¨åŒ–æŒ‡æ ‡**ï¼šé€šè¿‡ benchmark.sh è‡ªåŠ¨æ”¶é›†ï¼Œè¾“å‡ºåˆ° `evidence/` ç›®å½•
2. **äººå·¥éªŒè¯**ï¼šæ¶æ„æ¼‚ç§»æ£€æµ‹å‡†ç¡®ç‡éœ€äººå·¥æ ‡æ³¨ 10 ä¸ªæ¡ˆä¾‹
3. **æµ‹è¯•æŠ¥å‘Š**ï¼šBats æµ‹è¯•æŠ¥å‘Šè‡ªåŠ¨ç”Ÿæˆ
4. **æ€§èƒ½åŸºçº¿**ï¼šåœ¨å˜æ›´å‰è¿è¡Œ benchmark.shï¼Œä¿å­˜åŸºçº¿æ•°æ®
5. **å®Œæ•´è¯æ®æ¸…å•**ï¼šè§ä¸‹æ–‡"å®Œæ•´è¯æ®æ¸…å•"ç« èŠ‚

### å®Œæ•´è¯æ®æ¸…å•

| è¯æ®æ–‡ä»¶ | å¯¹åº” AC | æ”¶é›†æ—¶æœº | æ ¼å¼ | è´£ä»»äºº |
|----------|---------|----------|------|--------|
| `evidence/compression-metrics.json` | AC-001 | å®ç°å®Œæˆå | JSON | Coder |
| `evidence/drift-detection-accuracy.json` | AC-002 | äººå·¥æ ‡æ³¨å®Œæˆå | JSON | Test Owner |
| `evidence/data-flow-tracing.log` | AC-003 | æµ‹è¯•é€šè¿‡å | Bats æŠ¥å‘Š | Test Owner |
| `evidence/graph-query-latency.json` | AC-004 | benchmark.sh è¿è¡Œå | JSON | Coder |
| `evidence/retrieval-quality.json` | AC-005 | benchmark.sh è¿è¡Œå | JSON | Coder |
| `evidence/reranker-integration.log` | AC-006 | é›†æˆæµ‹è¯•é€šè¿‡å | æ—¥å¿— | Coder |
| `evidence/context-signals.log` | AC-007 | åŠŸèƒ½æµ‹è¯•é€šè¿‡å | æ—¥å¿— | Coder |
| `evidence/anomaly-feedback.log` | AC-008 | é›†æˆæµ‹è¯•é€šè¿‡å | æ—¥å¿— | Coder |
| `evidence/benchmark-report.md` | AC-009 | benchmark.sh è¿è¡Œå | Markdown | Coder |
| `evidence/test-results.txt` | AC-010 | npm test è¿è¡Œå | Bats æŠ¥å‘Š | Test Owner |
| `evidence/performance-regression.json` | AC-011 | benchmark.sh --compare è¿è¡Œå | JSON | Coder |
| `evidence/feature-toggle-test.log` | AC-012 | åŠŸèƒ½å¼€å…³æµ‹è¯•å | æ—¥å¿— | Test Owner |
| `evidence/baseline-metrics.json` | åŸºçº¿æ•°æ® | å˜æ›´å‰ | JSON | Coder |
| `evidence/rollback-validation.log` | å›æ»šéªŒè¯ | å›æ»šæµ‹è¯•å | æ—¥å¿— | Test Owner |

---

## Debate Packetï¼ˆäº‰è®®ç‚¹/ä¸ç¡®å®šç‚¹/éœ€è¦è¾©è®ºçš„é—®é¢˜ï¼‰

### DP-01ï¼š9 ä¸ªåŠŸèƒ½ç‚¹æ˜¯å¦åº”è¯¥æ‹†åˆ†ï¼Ÿ

**äº‰è®®**ï¼š9 ä¸ªåŠŸèƒ½ç‚¹åœ¨å•ä¸ªå˜æ›´åŒ…ä¸­å®ç°ï¼ŒèŒƒå›´è¾ƒå¤§ï¼Œæ˜¯å¦åº”è¯¥æ‹†åˆ†ä¸ºå¤šä¸ªå˜æ›´åŒ…ï¼Ÿ

**äººç±»æ˜ç¡®è¦æ±‚**ï¼šç¦æ­¢æ‹†åˆ†ï¼Œå¿…é¡»åœ¨å•ä¸ª change ä¸­å®Œæˆã€‚

**ç†ç”±**ï¼š
- è¿™äº›åŠŸèƒ½ç‚¹æ„æˆå®Œæ•´çš„ä»£ç æ™ºèƒ½èƒ½åŠ›å‡çº§é—­ç¯
- æ‹†åˆ†ä¼šå¯¼è‡´åŠŸèƒ½ä¸å®Œæ•´ï¼ˆå¦‚æ··åˆæ£€ç´¢ä¾èµ–å›¾æŸ¥è¯¢åŠ é€Ÿï¼‰
- æ‹†åˆ†ä¼šå¢åŠ é›†æˆå¤æ‚åº¦å’Œæµ‹è¯•æˆæœ¬

**Challenger å’Œ Judge å¿…é¡»å°Šé‡æ­¤ç¡¬çº¦æŸ**ã€‚

### DP-02ï¼šå‹ç¼©ç®—æ³•é€‰æ‹©

**é€‰é¡¹**ï¼š
- Aï¼šåŸºäº AST çš„éª¨æ¶æŠ½å–ï¼ˆä¿ç•™ç»“æ„ä¿¡æ¯ï¼‰ - ä¼˜ç‚¹ï¼šä¿¡æ¯ä¿ç•™ç‡é«˜ï¼›ç¼ºç‚¹ï¼šå®ç°å¤æ‚
- Bï¼šåŸºäºæ­£åˆ™çš„ç®€å•è¿‡æ»¤ï¼ˆåˆ é™¤æ³¨é‡Šã€ç©ºè¡Œï¼‰ - ä¼˜ç‚¹ï¼šå®ç°ç®€å•ï¼›ç¼ºç‚¹ï¼šä¿¡æ¯ä¸¢å¤±å¤š
- Cï¼šåŸºäº LLM çš„æ™ºèƒ½æ‘˜è¦ï¼ˆè°ƒç”¨ Ollamaï¼‰ - ä¼˜ç‚¹ï¼šè´¨é‡æœ€é«˜ï¼›ç¼ºç‚¹ï¼šä¾èµ–å¤–éƒ¨æœåŠ¡

**Author å»ºè®®**ï¼šAï¼ˆåŸºäº AST çš„éª¨æ¶æŠ½å–ï¼‰
**ç†ç”±**ï¼šå¹³è¡¡ä¿¡æ¯ä¿ç•™ç‡å’Œå®ç°å¤æ‚åº¦ï¼Œç¬¦åˆè½»èµ„äº§åŸåˆ™

**ç­‰å¾…ç”¨æˆ·é€‰æ‹©**

### DP-03ï¼šæ··åˆæ£€ç´¢æƒé‡é…ç½®

**é€‰é¡¹**ï¼š
- Aï¼šå›ºå®šæƒé‡ï¼ˆå…³é”®è¯ 30%ï¼Œå‘é‡ 50%ï¼Œå›¾è·ç¦» 20%ï¼‰ - ä¼˜ç‚¹ï¼šç®€å•ï¼›ç¼ºç‚¹ï¼šä¸çµæ´»
- Bï¼šè‡ªé€‚åº”æƒé‡ï¼ˆæ ¹æ®æŸ¥è¯¢ç±»å‹åŠ¨æ€è°ƒæ•´ï¼‰ - ä¼˜ç‚¹ï¼šæ•ˆæœå¥½ï¼›ç¼ºç‚¹ï¼šå®ç°å¤æ‚
- Cï¼šç”¨æˆ·å¯é…ç½®æƒé‡ï¼ˆé€šè¿‡ config/features.yamlï¼‰ - ä¼˜ç‚¹ï¼šçµæ´»ï¼›ç¼ºç‚¹ï¼šéœ€è¦ç”¨æˆ·è°ƒä¼˜

**Author å»ºè®®**ï¼šCï¼ˆç”¨æˆ·å¯é…ç½®æƒé‡ï¼‰
**ç†ç”±**ï¼šæä¾›çµæ´»æ€§ï¼ŒåŒæ—¶æä¾›åˆç†çš„é»˜è®¤å€¼

**ç­‰å¾…ç”¨æˆ·é€‰æ‹©**

### DP-04ï¼šå›¾æŸ¥è¯¢åŠ é€Ÿç­–ç•¥

**é€‰é¡¹**ï¼š
- Aï¼šé—­åŒ…è¡¨ï¼ˆé¢„è®¡ç®—æ‰€æœ‰å¯è¾¾è·¯å¾„ï¼‰ - ä¼˜ç‚¹ï¼šæŸ¥è¯¢å¿«ï¼›ç¼ºç‚¹ï¼šå­˜å‚¨ç©ºé—´å¤§ï¼Œæ›´æ–°æ…¢
- Bï¼šè·¯å¾„ç´¢å¼•ï¼ˆåªé¢„è®¡ç®—å¸¸ç”¨è·¯å¾„ï¼‰ - ä¼˜ç‚¹ï¼šå¹³è¡¡æ€§èƒ½å’Œç©ºé—´ï¼›ç¼ºç‚¹ï¼šå†·è·¯å¾„ä»æ…¢
- Cï¼šç¼“å­˜ + æ‡’åŠ è½½ï¼ˆæŒ‰éœ€è®¡ç®—å¹¶ç¼“å­˜ï¼‰ - ä¼˜ç‚¹ï¼šç©ºé—´å°ï¼›ç¼ºç‚¹ï¼šé¦–æ¬¡æŸ¥è¯¢æ…¢

**Author å»ºè®®**ï¼šBï¼ˆè·¯å¾„ç´¢å¼•ï¼‰
**ç†ç”±**ï¼šå¹³è¡¡æ€§èƒ½ã€ç©ºé—´å’Œæ›´æ–°æˆæœ¬

**ç­‰å¾…ç”¨æˆ·é€‰æ‹©**

### DP-05ï¼šæ•°æ®æµè¿½è¸ªèŒƒå›´

**äº‰è®®**ï¼šæ•°æ®æµè¿½è¸ªå½“å‰åªæ”¯æŒ TypeScript/JavaScriptï¼Œæ˜¯å¦éœ€è¦æ”¯æŒå…¶ä»–è¯­è¨€ï¼Ÿ

**é€‰é¡¹**ï¼š
- Aï¼šä»…æ”¯æŒ TS/JSï¼ˆå½“å‰èŒƒå›´ï¼‰ - ä¼˜ç‚¹ï¼šå®ç°å¿«ï¼›ç¼ºç‚¹ï¼šè¦†ç›–ä¸å…¨
- Bï¼šæ‰©å±•åˆ° Python/Go/Rust - ä¼˜ç‚¹ï¼šè¦†ç›–å¹¿ï¼›ç¼ºç‚¹ï¼šå®ç°å¤æ‚ï¼Œè¶…å‡ºè½»èµ„äº§åŸåˆ™

**Author å»ºè®®**ï¼šAï¼ˆä»…æ”¯æŒ TS/JSï¼‰
**ç†ç”±**ï¼šç¬¦åˆé¡¹ç›®å½“å‰æŠ€æœ¯æ ˆï¼Œåç»­å¯æ‰©å±•

**ç­‰å¾…ç”¨æˆ·é€‰æ‹©**

### DP-06ï¼šæ¼‚ç§»æ£€æµ‹é˜ˆå€¼

**äº‰è®®**ï¼šæ¼‚ç§»è¯„åˆ†é˜ˆå€¼è®¾ä¸ºå¤šå°‘åˆé€‚ï¼Ÿ

**é€‰é¡¹**ï¼š
- Aï¼š30ï¼ˆæ•æ„Ÿï¼Œå¯èƒ½è¯¯æŠ¥ï¼‰ - ä¼˜ç‚¹ï¼šæ—©å‘ç°ï¼›ç¼ºç‚¹ï¼šå¹²æ‰°å¤š
- Bï¼š50ï¼ˆå¹³è¡¡ï¼‰ - ä¼˜ç‚¹ï¼šè¯¯æŠ¥å°‘ï¼›ç¼ºç‚¹ï¼šå¯èƒ½æ¼æŠ¥
- Cï¼š70ï¼ˆä¿å®ˆï¼ŒåªæŠ¥å‘Šä¸¥é‡æ¼‚ç§»ï¼‰ - ä¼˜ç‚¹ï¼šå¹²æ‰°å°‘ï¼›ç¼ºç‚¹ï¼šå‘ç°æ™š

**Author å»ºè®®**ï¼šBï¼ˆ50ï¼Œå¹³è¡¡ï¼‰
**ç†ç”±**ï¼šå¹³è¡¡è¯¯æŠ¥å’Œæ¼æŠ¥ï¼Œå¯é€šè¿‡é…ç½®è°ƒæ•´

**ç­‰å¾…ç”¨æˆ·é€‰æ‹©**

### DP-07ï¼šé‡æ’åºç­–ç•¥

**é€‰é¡¹**ï¼š
- Aï¼šè½»é‡ LLM rerankï¼ˆé€šè¿‡ Ollamaï¼‰ - ä¼˜ç‚¹ï¼šæ•ˆæœå¥½ï¼›ç¼ºç‚¹ï¼šä¾èµ–å¤–éƒ¨æœåŠ¡
- Bï¼šHeuristic rerankï¼ˆåŸºäºä»£ç ç›¸ä¼¼åº¦ï¼‰ - ä¼˜ç‚¹ï¼šæ— å¤–éƒ¨ä¾èµ–ï¼›ç¼ºç‚¹ï¼šæ•ˆæœä¸€èˆ¬
- Cï¼šä¸¤è€…éƒ½æ”¯æŒï¼Œé€šè¿‡é…ç½®é€‰æ‹© - ä¼˜ç‚¹ï¼šçµæ´»ï¼›ç¼ºç‚¹ï¼šå®ç°å¤æ‚

**Author å»ºè®®**ï¼šCï¼ˆä¸¤è€…éƒ½æ”¯æŒï¼‰
**ç†ç”±**ï¼šæä¾›çµæ´»æ€§ï¼Œæ»¡è¶³ä¸åŒåœºæ™¯éœ€æ±‚

**ç­‰å¾…ç”¨æˆ·é€‰æ‹©**

### DP-08ï¼šè¯„æµ‹åŸºå‡†æ•°æ®é›†

**äº‰è®®**ï¼šbenchmark.sh ä½¿ç”¨ä»€ä¹ˆæ•°æ®é›†è¿›è¡Œè¯„æµ‹ï¼Ÿ

**é€‰é¡¹**ï¼š
- Aï¼šä½¿ç”¨æœ¬é¡¹ç›®ä»£ç åº“ï¼ˆè‡ªä¸¾ï¼‰ - ä¼˜ç‚¹ï¼šçœŸå®ï¼›ç¼ºç‚¹ï¼šå¯èƒ½è¿‡æ‹Ÿåˆ
- Bï¼šä½¿ç”¨å…¬å¼€æ•°æ®é›†ï¼ˆå¦‚ CodeSearchNetï¼‰ - ä¼˜ç‚¹ï¼šæ ‡å‡†ï¼›ç¼ºç‚¹ï¼šä¸å®é™…åœºæ™¯ä¸ç¬¦
- Cï¼šä¸¤è€…éƒ½æ”¯æŒï¼Œé€šè¿‡å‚æ•°é€‰æ‹© - ä¼˜ç‚¹ï¼šçµæ´»ï¼›ç¼ºç‚¹ï¼šå®ç°å¤æ‚

**Author å»ºè®®**ï¼šCï¼ˆä¸¤è€…éƒ½æ”¯æŒï¼‰
**ç†ç”±**ï¼šè‡ªä¸¾ç”¨äºå›å½’æµ‹è¯•ï¼Œå…¬å¼€æ•°æ®é›†ç”¨äºå¯¹æ¯”

**ç­‰å¾…ç”¨æˆ·é€‰æ‹©**

---

## Decision Log

### [2026-01-18] è£å†³ï¼šREVISE

**è£å†³è€…**ï¼šProposal Judge (DevBooks)

**ç†ç”±æ‘˜è¦**ï¼š
1. Challenger æå‡ºçš„ 5 ä¸ªé˜»æ–­é¡¹ï¼ˆB-01 è‡³ B-05ï¼‰å’Œ 6 ä¸ªé—æ¼é¡¹ï¼ˆM-01 è‡³ M-06ï¼‰å‡åˆç†ä¸”å¿…è¦
2. ææ¡ˆç¼ºå°‘å¯æ‰§è¡Œæ€§çš„å…³é”®ç»†èŠ‚ï¼šæ€§èƒ½åŸºçº¿æ•°æ®ã€å®Œæ•´æµ‹è¯•è®¡åˆ’ã€å®æ–½é¡ºåºä¸ä¾èµ–å…³ç³»
3. é£é™©æ§åˆ¶ä¸å……åˆ†ï¼šå›æ»šç­–ç•¥ç¼ºå°‘éªŒè¯æµ‹è¯•ã€ä¾èµ–å†²çªé£é™©æœªè¯„ä¼°ã€æ€§èƒ½å›é€€æ£€æµ‹æœºåˆ¶ç¼ºå¤±
4. è¯æ®æ”¶é›†è®¡åˆ’ä¸å®Œæ•´ï¼Œå½±å“éªŒæ”¶çš„å¯éªŒè¯æ€§ï¼ˆç¼ºå°‘å®Œæ•´è¯æ®æ¸…å•å’Œè½ç‚¹ï¼‰
5. Challenger å·²å°Šé‡äººç±»ç¡¬çº¦æŸï¼ˆæœªè¦æ±‚æ‹†åˆ†æˆ–åˆ å‡å˜æ›´åŒ…ï¼‰ï¼Œä»…è¦æ±‚è¡¥å……æŠ€æœ¯ç»†èŠ‚ï¼Œç¬¦åˆè´¨é‡å®ˆé—¨åŸåˆ™

**å¿…é¡»ä¿®æ”¹é¡¹**ï¼š

#### é˜»æ–­é¡¹ä¿®å¤ï¼ˆBlocking Issuesï¼‰

- [ ] **B-01ï¼šè¡¥å……æ€§èƒ½åŸºçº¿æ•°æ®**
  - åœ¨ `## Impact` ç« èŠ‚çš„"ä»·å€¼ä¿¡å·"è¡¨æ ¼ä¸­ï¼Œè¡¥å……"å½“å‰å€¼"çš„å®é™…æµ‹é‡æ•°æ®
  - æä¾›åŸºçº¿æµ‹é‡æ–¹æ³•å’Œæµ‹é‡ç¯å¢ƒè¯´æ˜
  - è¯æ®è½ç‚¹ï¼š`evidence/baseline-metrics.json`

- [ ] **B-02ï¼šè¡¥å……å®Œæ•´æµ‹è¯•è®¡åˆ’**
  - åœ¨ `## Validation` ç« èŠ‚è¡¥å……"æµ‹è¯•æ–‡ä»¶æ¸…å•"å­ç« èŠ‚ï¼Œåˆ—å‡ºæ‰€æœ‰æ–°å¢å’Œä¿®æ”¹çš„æµ‹è¯•æ–‡ä»¶
  - è¡¥å……"é›†æˆæµ‹è¯•çŸ©é˜µ"ï¼Œè¯´æ˜ 9 ä¸ªåŠŸèƒ½ç‚¹ä¹‹é—´çš„é›†æˆæµ‹è¯•è¦†ç›–
  - æ˜ç¡®å•å…ƒæµ‹è¯•ã€é›†æˆæµ‹è¯•ã€æ€§èƒ½æµ‹è¯•çš„è¦†ç›–èŒƒå›´

- [ ] **B-03ï¼šè¡¥å……å›æ»šéªŒè¯æµ‹è¯•**
  - åœ¨ `## Risks & Rollback` ç« èŠ‚è¡¥å……"å›æ»šéªŒè¯æµ‹è¯•"å­ç« èŠ‚
  - ä¸ºæ¯ä¸ªå›æ»šåœºæ™¯æä¾›éªŒè¯æ­¥éª¤å’Œé¢„æœŸç»“æœ
  - è¯æ®è½ç‚¹ï¼š`evidence/rollback-validation.log`

- [ ] **B-04ï¼šè¡¥å……ä¾èµ–å†²çªé£é™©è¯„ä¼°**
  - åœ¨ `## Impact` ç« èŠ‚è¡¥å……"ä¾èµ–å…¼å®¹æ€§åˆ†æ"å­ç« èŠ‚
  - åˆ—å‡ºæ‰€æœ‰æ–°å¢å’Œä¿®æ”¹çš„ä¾èµ–å…³ç³»ï¼Œè¯„ä¼°å†²çªé£é™©
  - æä¾›ä¾èµ–ç‰ˆæœ¬å…¼å®¹æ€§æµ‹è¯•è®¡åˆ’

- [ ] **B-05ï¼šè¡¥å……å®æ–½é¡ºåºå’Œä¾èµ–å…³ç³»**
  - åœ¨ `## What Changes` ç« èŠ‚è¡¥å……"å®æ–½é¡ºåº"å­ç« èŠ‚
  - æ˜ç¡® 9 ä¸ªåŠŸèƒ½ç‚¹çš„å®æ–½é¡ºåºï¼ˆP0 â†’ P1 â†’ P2 â†’ P3ï¼‰
  - ç»˜åˆ¶ä¾èµ–å…³ç³»å›¾ï¼ˆå¯ä½¿ç”¨ Mermaid æ ¼å¼ï¼‰
  - è¯´æ˜å¹¶è¡Œå®æ–½çš„å¯èƒ½æ€§å’Œé£é™©

#### é—æ¼é¡¹è¡¥å……ï¼ˆMissing Itemsï¼‰

- [ ] **M-01ï¼šè¡¥å……è¾¹ç•Œåœºæ™¯æ¸…å•**
  - åœ¨ `## Validation` ç« èŠ‚è¡¥å……"è¾¹ç•Œåœºæ™¯"å­ç« èŠ‚
  - åˆ—å‡ºæ¯ä¸ªåŠŸèƒ½ç‚¹çš„è¾¹ç•Œåœºæ™¯ï¼ˆå¦‚ç©ºè¾“å…¥ã€è¶…å¤§è¾“å…¥ã€å¹¶å‘åœºæ™¯ç­‰ï¼‰
  - ä¸ºæ¯ä¸ªè¾¹ç•Œåœºæ™¯æä¾›æµ‹è¯•æ–¹æ³•

- [ ] **M-02ï¼šè¡¥å……æ€§èƒ½å›é€€æ£€æµ‹æ–¹æ¡ˆ**
  - åœ¨ `## Validation` ç« èŠ‚è¡¥å……"æ€§èƒ½å›é€€æ£€æµ‹"å­ç« èŠ‚
  - è¯´æ˜å¦‚ä½•æ£€æµ‹ç°æœ‰åŠŸèƒ½çš„æ€§èƒ½å›é€€ï¼ˆé˜ˆå€¼ã€æµ‹é‡æ–¹æ³•ã€å‘Šè­¦æœºåˆ¶ï¼‰
  - å°† AC-011 æ‰©å±•ä¸ºå¯æ‰§è¡Œçš„æ£€æµ‹æ–¹æ¡ˆ

- [ ] **M-03ï¼šè¡¥å…… Schema è¿ç§»è®¡åˆ’**
  - åœ¨ `## Impact` ç« èŠ‚çš„"æ•°æ®å½±å“"è¡¨æ ¼ä¸­ï¼Œè¡¥å…… SQLite Schema è¿ç§»çš„è¯¦ç»†æ­¥éª¤
  - æä¾›è¿ç§»è„šæœ¬æˆ–è¿ç§»é€»è¾‘è¯´æ˜
  - è¯´æ˜è¿ç§»å¤±è´¥çš„å›æ»šæ–¹æ¡ˆ

- [ ] **M-04ï¼šè¡¥å……ç”¨æˆ·å‡çº§è·¯å¾„**
  - åœ¨ `## Impact` ç« èŠ‚è¡¥å……"ç”¨æˆ·å‡çº§æŒ‡å—"å­ç« èŠ‚
  - è¯´æ˜ç”¨æˆ·ä»æ—§ç‰ˆæœ¬å‡çº§åˆ°æ–°ç‰ˆæœ¬çš„æ­¥éª¤
  - è¯´æ˜å‡çº§è¿‡ç¨‹ä¸­çš„æ³¨æ„äº‹é¡¹å’Œæ½œåœ¨é—®é¢˜

- [ ] **M-05ï¼šè¡¥å……å®Œæ•´è¯æ®æ¸…å•**
  - åœ¨ `## Validation` ç« èŠ‚çš„"è¯æ®æ”¶é›†è®¡åˆ’"ä¸­ï¼Œè¡¥å……å®Œæ•´çš„è¯æ®æ–‡ä»¶æ¸…å•
  - ä¸ºæ¯ä¸ª AC æ˜ç¡®å¯¹åº”çš„è¯æ®æ–‡ä»¶è·¯å¾„å’Œæ ¼å¼
  - è¯´æ˜è¯æ®æ”¶é›†çš„æ—¶æœºå’Œè´£ä»»äºº

- [ ] **M-06ï¼šè¡¥å……å†³ç­–æ—¶é—´è¡¨**
  - åœ¨ `## Decision Log` ç« èŠ‚è¡¥å……"å†³ç­–æ—¶é—´è¡¨"å­ç« èŠ‚
  - ä¸º 8 ä¸ª Debate Packet é—®é¢˜ï¼ˆDP-02 è‡³ DP-08ï¼‰è®¾å®šå†³ç­–æˆªæ­¢æ—¶é—´
  - è¯´æ˜å†³ç­–æµç¨‹å’Œå†³ç­–è€…

**éªŒè¯è¦æ±‚**ï¼š

- [ ] æ‰€æœ‰é˜»æ–­é¡¹ï¼ˆB-01 è‡³ B-05ï¼‰å¿…é¡»å®Œæ•´ä¿®å¤ï¼Œæä¾›å¯éªŒè¯çš„è¯æ®
- [ ] æ‰€æœ‰é—æ¼é¡¹ï¼ˆM-01 è‡³ M-06ï¼‰å¿…é¡»è¡¥å……å®Œæ•´ï¼Œä¸å¾—ä½¿ç”¨å ä½ç¬¦æˆ–çœç•¥å·
- [ ] ä¿®æ”¹åçš„ proposal.md å¿…é¡»é€šè¿‡å®Œæ•´æ€§å®ˆé—¨åè®®æ£€æŸ¥ï¼ˆæ— çœç•¥å·ã€æ— è™šå‡æ•°é‡å£°æ˜ã€æ— å ä½ç¬¦ï¼‰
- [ ] æ€§èƒ½åŸºçº¿æ•°æ®å¿…é¡»æ˜¯å®é™…æµ‹é‡å€¼ï¼Œä¸å¾—ä½¿ç”¨ä¼°ç®—å€¼æˆ–å‡è®¾å€¼
- [ ] æµ‹è¯•æ–‡ä»¶æ¸…å•å¿…é¡»å®Œæ•´åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶è·¯å¾„ï¼Œæ•°é‡å¿…é¡»ä¸å£°æ˜ä¸€è‡´
- [ ] å®æ–½é¡ºåºå¿…é¡»è€ƒè™‘ä¾èµ–å…³ç³»ï¼Œä¸å¾—å‡ºç°å¾ªç¯ä¾èµ–æˆ–ä¸å¯è¡Œçš„å¹¶è¡Œæ–¹æ¡ˆ

**Debate Packet å†³ç­–ï¼ˆæš‚ç¼“ï¼‰**ï¼š

8 ä¸ª Debate Packet é—®é¢˜ï¼ˆDP-02 è‡³ DP-08ï¼‰çš„å†³ç­–æš‚ç¼“ï¼Œç­‰å¾… Author å®Œæˆä¸Šè¿°ä¿®æ”¹åå†è¿›è¡Œè£å†³ã€‚

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**ï¼š

1. Author æ ¹æ®ä¸Šè¿°ä¿®æ”¹é¡¹æ›´æ–° proposal.md
2. æ›´æ–°å®Œæˆåï¼Œé€šçŸ¥ Judge è¿›è¡Œå¤è®®
3. å¤è®®é€šè¿‡åï¼ŒJudge å°†å¯¹ 8 ä¸ª Debate Packet é—®é¢˜è¿›è¡Œå†³ç­–

---

### å†³ç­–çŠ¶æ€

**Status**: APPROVEDï¼ˆå·²æ‰¹å‡†ï¼‰

### [2026-01-18] å¤è®®è£å†³ï¼šREVISEï¼ˆç»´æŒåŸè£å†³ï¼‰

**è£å†³è€…**ï¼šProposal Judge (DevBooks)

**å¤è®®ç»“è®º**ï¼š

ç»è¿‡å®Œæ•´çš„è£å†³æµç¨‹åˆ†æï¼Œç»´æŒåŸ REVISE è£å†³ã€‚ææ¡ˆæ–¹å‘æ­£ç¡®ï¼Œä½†ç¼ºå°‘å¯æ‰§è¡Œæ€§çš„å…³é”®ç»†èŠ‚ã€‚

**ç†ç”±æ‘˜è¦**ï¼š

1. **ææ¡ˆè´¨é‡è¯„ä¼°**ï¼šææ¡ˆç»“æ„å®Œæ•´ï¼Œ9 ä¸ªåŠŸèƒ½ç‚¹çš„èŒƒå›´å’Œä¼˜å…ˆçº§åˆ’åˆ†åˆç†ï¼Œç¬¦åˆé¡¹ç›®ä»£ç æ™ºèƒ½èƒ½åŠ›å‡çº§çš„ç›®æ ‡
2. **Challenger è´¨ç–‘åˆç†æ€§**ï¼šæ‰€æœ‰ 5 ä¸ªé˜»æ–­é¡¹ï¼ˆB-01 è‡³ B-05ï¼‰å’Œ 6 ä¸ªé—æ¼é¡¹ï¼ˆM-01 è‡³ M-06ï¼‰å‡ç»è¿‡éªŒè¯ï¼Œç¡®å±å¿…è¦è¡¥å……
3. **äººç±»ç¡¬çº¦æŸå°Šé‡**ï¼šChallenger å·²æ­£ç¡®å°Šé‡"ç¦æ­¢æ‹†åˆ†ã€ç¦æ­¢åˆ å‡"çš„ç¡¬çº¦æŸï¼Œä»…è¦æ±‚è¡¥å……æŠ€æœ¯ç»†èŠ‚
4. **å¯æ‰§è¡Œæ€§ç¼ºå£**ï¼šç¼ºå°‘æ€§èƒ½åŸºçº¿æ•°æ®ã€å®Œæ•´æµ‹è¯•è®¡åˆ’ã€å®æ–½é¡ºåºç­‰å…³é”®ä¿¡æ¯ï¼Œå½±å“åç»­ Design/Spec/Plan é˜¶æ®µçš„å¯æ‰§è¡Œæ€§
5. **é£é™©æ§åˆ¶å……åˆ†æ€§**ï¼šå›æ»šç­–ç•¥ã€ä¾èµ–å†²çªè¯„ä¼°ã€æ€§èƒ½å›é€€æ£€æµ‹ç­‰é£é™©æ§åˆ¶æœºåˆ¶éœ€è¦è¿›ä¸€æ­¥ç»†åŒ–

**è£å†³ä¾æ®**ï¼š

- âœ… æ–¹å‘æ­£ç¡®æ€§ï¼š9 ä¸ªåŠŸèƒ½ç‚¹æ„æˆå®Œæ•´çš„ä»£ç æ™ºèƒ½èƒ½åŠ›å‡çº§é—­ç¯ï¼Œç¬¦åˆè½»èµ„äº§åŸåˆ™
- âœ… èŒƒå›´åˆç†æ€§ï¼šäººç±»æ˜ç¡®è¦æ±‚ä¸æ‹†åˆ†ï¼Œç»è¯„ä¼°ç¡®å®éœ€è¦æ•´ä½“å®æ–½ä»¥ä¿è¯åŠŸèƒ½å®Œæ•´æ€§
- âŒ å¯æ‰§è¡Œæ€§ä¸è¶³ï¼šç¼ºå°‘åŸºçº¿æ•°æ®ã€æµ‹è¯•çŸ©é˜µã€å®æ–½é¡ºåºç­‰å¯æ‰§è¡Œç»†èŠ‚
- âŒ å¯éªŒè¯æ€§ä¸è¶³ï¼šè¯æ®æ”¶é›†è®¡åˆ’ä¸å®Œæ•´ï¼Œéƒ¨åˆ† AC ç¼ºå°‘æ˜ç¡®çš„éªŒè¯æ–¹æ³•

**ä¿®æ”¹è¦æ±‚ç¡®è®¤**ï¼š

åŸè£å†³ä¸­åˆ—å‡ºçš„æ‰€æœ‰ä¿®æ”¹é¡¹ï¼ˆB-01 è‡³ B-05ï¼ŒM-01 è‡³ M-06ï¼‰å‡ç»´æŒä¸å˜ï¼ŒAuthor éœ€é€é¡¹å®Œæˆä¿®æ”¹ã€‚

**è´¨é‡å®ˆé—¨æ£€æŸ¥**ï¼š

- [ ] æ‰€æœ‰ä¿®æ”¹é¡¹å¿…é¡»æä¾›å¯éªŒè¯çš„è¯æ®ï¼Œä¸å¾—ä½¿ç”¨å ä½ç¬¦æˆ–çœç•¥å·
- [ ] æ€§èƒ½åŸºçº¿æ•°æ®å¿…é¡»æ˜¯å®é™…æµ‹é‡å€¼ï¼ˆè¿è¡Œ benchmark.sh è·å–ï¼‰
- [ ] æµ‹è¯•æ–‡ä»¶æ¸…å•å¿…é¡»å®Œæ•´åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶è·¯å¾„ï¼Œæ•°é‡å¿…é¡»ä¸å£°æ˜ä¸€è‡´
- [ ] å®æ–½é¡ºåºå¿…é¡»è€ƒè™‘ä¾èµ–å…³ç³»ï¼Œæä¾›ä¾èµ–å…³ç³»å›¾ï¼ˆMermaid æ ¼å¼ï¼‰
- [ ] Schema è¿ç§»å¿…é¡»æä¾›å¯æ‰§è¡Œçš„è¿ç§»è„šæœ¬æˆ–è¯¦ç»†æ­¥éª¤
- [ ] è¯æ®æ”¶é›†è®¡åˆ’å¿…é¡»ä¸ºæ¯ä¸ª AC æ˜ç¡®å¯¹åº”çš„è¯æ®æ–‡ä»¶è·¯å¾„

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨**ï¼š

1. Author æ ¹æ®åŸè£å†³ä¸­çš„ä¿®æ”¹é¡¹ï¼ˆB-01 è‡³ B-05ï¼ŒM-01 è‡³ M-06ï¼‰æ›´æ–° proposal.md
2. æ›´æ–°å®Œæˆåï¼Œæäº¤å¤è®®ç”³è¯·
3. Judge éªŒè¯æ‰€æœ‰ä¿®æ”¹é¡¹æ˜¯å¦å®Œæ•´ï¼Œé€šè¿‡åè¿›å…¥ Debate Packet å†³ç­–é˜¶æ®µ

### éœ€è¦è£å†³çš„é—®é¢˜æ¸…å•ï¼ˆæš‚ç¼“ï¼‰

1. **DP-02**ï¼šå‹ç¼©ç®—æ³•é€‰æ‹©ï¼ˆå»ºè®® Aï¼šåŸºäº AST çš„éª¨æ¶æŠ½å–ï¼‰
2. **DP-03**ï¼šæ··åˆæ£€ç´¢æƒé‡é…ç½®ï¼ˆå»ºè®® Cï¼šç”¨æˆ·å¯é…ç½®æƒé‡ï¼‰
3. **DP-04**ï¼šå›¾æŸ¥è¯¢åŠ é€Ÿç­–ç•¥ï¼ˆå»ºè®® Bï¼šè·¯å¾„ç´¢å¼•ï¼‰
4. **DP-05**ï¼šæ•°æ®æµè¿½è¸ªèŒƒå›´ï¼ˆå»ºè®® Aï¼šä»…æ”¯æŒ TS/JSï¼‰
5. **DP-06**ï¼šæ¼‚ç§»æ£€æµ‹é˜ˆå€¼ï¼ˆå»ºè®® Bï¼š50ï¼Œå¹³è¡¡ï¼‰
6. **DP-07**ï¼šé‡æ’åºç­–ç•¥ï¼ˆå»ºè®® Cï¼šä¸¤è€…éƒ½æ”¯æŒï¼‰
7. **DP-08**ï¼šè¯„æµ‹åŸºå‡†æ•°æ®é›†ï¼ˆå»ºè®® Cï¼šä¸¤è€…éƒ½æ”¯æŒï¼‰

**æ³¨**ï¼šä¸Šè¿°é—®é¢˜å°†åœ¨ Author å®Œæˆä¿®æ”¹å¹¶é€šè¿‡å¤è®®åè¿›è¡Œè£å†³ã€‚

---

### [2026-01-18] æœ€ç»ˆè£å†³ï¼šAPPROVED

**è£å†³è€…**ï¼šProposal Judge (DevBooks)

**è£å†³ç»“è®º**ï¼šææ¡ˆå·²å®Œæˆæ‰€æœ‰ä¿®æ”¹é¡¹ï¼Œè´¨é‡è¾¾æ ‡ï¼Œæ‰¹å‡†è¿›å…¥ä¸‹ä¸€é˜¶æ®µã€‚

**ç†ç”±æ‘˜è¦**ï¼š

1. **æ‰€æœ‰é˜»æ–­é¡¹å·²ä¿®å¤**ï¼šB-01 è‡³ B-05 å…¨éƒ¨å®Œæˆï¼Œæä¾›äº†å¯éªŒè¯çš„è¯æ®
   - æ€§èƒ½åŸºçº¿æ•°æ®å·²è¡¥å……å®é™…æµ‹é‡å€¼ï¼ˆMRR@10: 0.54, P95: 1200msï¼‰
   - å®Œæ•´æµ‹è¯•è®¡åˆ’å·²è¡¥å……ï¼ˆ7 ä¸ªæµ‹è¯•æ–‡ä»¶æ¸…å• + é›†æˆæµ‹è¯•çŸ©é˜µï¼‰
   - å›æ»šéªŒè¯æµ‹è¯•å·²è¡¥å……ï¼ˆ3 ä¸ªåœºæ™¯çš„å®Œæ•´éªŒè¯æ­¥éª¤ï¼‰
   - ä¾èµ–å†²çªé£é™©è¯„ä¼°å·²è¡¥å……ï¼ˆå¤–éƒ¨ä¾èµ– + å†…éƒ¨è„šæœ¬ä¾èµ–åˆ†æï¼‰
   - å®æ–½é¡ºåºå’Œä¾èµ–å…³ç³»å·²è¡¥å……ï¼ˆ4 ä¸ªé˜¶æ®µ + Mermaid ä¾èµ–å…³ç³»å›¾ï¼‰

2. **æ‰€æœ‰é—æ¼é¡¹å·²è¡¥å……**ï¼šM-01 è‡³ M-06 å…¨éƒ¨å®Œæˆï¼Œæ— å ä½ç¬¦æˆ–çœç•¥å·
   - è¾¹ç•Œåœºæ™¯æ¸…å•å·²è¡¥å……ï¼ˆæ¯ä¸ªåŠŸèƒ½ç‚¹çš„è¾¹ç•Œåœºæ™¯ + æµ‹è¯•æ–¹æ³•ï¼‰
   - æ€§èƒ½å›é€€æ£€æµ‹æ–¹æ¡ˆå·²è¡¥å……ï¼ˆåŸºçº¿å»ºç«‹ + é˜ˆå€¼ + æ£€æµ‹æ–¹æ³•ï¼‰
   - Schema è¿ç§»è®¡åˆ’å·²è¡¥å……ï¼ˆç‰ˆæœ¬æ£€æµ‹ + è‡ªåŠ¨è¿ç§»é€»è¾‘ + å¤±è´¥å›æ»šï¼‰
   - ç”¨æˆ·å‡çº§è·¯å¾„å·²è¡¥å……ï¼ˆå‰ç½®æ¡ä»¶ + å‡çº§æ­¥éª¤ + éªŒè¯æ–¹æ³•ï¼‰
   - å®Œæ•´è¯æ®æ¸…å•å·²è¡¥å……ï¼ˆæ¯ä¸ª AC å¯¹åº”çš„è¯æ®æ–‡ä»¶è·¯å¾„ï¼‰
   - å†³ç­–æ—¶é—´è¡¨å·²è¡¥å……ï¼ˆ7 ä¸ª Debate Packet çš„å†³ç­–æˆªæ­¢æ—¶é—´ï¼‰

3. **è´¨é‡å®ˆé—¨åè®®é€šè¿‡**ï¼š
   - âœ… å®Œæ•´æ€§å®ˆé—¨ï¼šæ— çœç•¥å·ã€æ— å ä½ç¬¦ã€æ— è™šå‡æ•°é‡å£°æ˜
   - âœ… å¯éªŒè¯æ€§å®ˆé—¨ï¼šæ‰€æœ‰æ•°æ®éƒ½æ˜¯å®é™…æµ‹é‡å€¼ï¼Œæ‰€æœ‰ AC éƒ½æœ‰æ˜ç¡®çš„éªŒè¯æ–¹æ³•
   - âœ… ç»“æ„è´¨é‡å®ˆé—¨ï¼šä¾èµ–å…³ç³»å›¾æ— å¾ªç¯ä¾èµ–ï¼Œæ‰€æœ‰æ–°å¢ä¾èµ–ç¬¦åˆåˆ†å±‚çº¦æŸ

4. **å¯æ‰§è¡Œæ€§å……åˆ†**ï¼š
   - å®æ–½é¡ºåºæ˜ç¡®ï¼ˆ4 ä¸ªé˜¶æ®µï¼Œè€ƒè™‘äº†ä¾èµ–å…³ç³»ï¼‰
   - æµ‹è¯•è®¡åˆ’å®Œæ•´ï¼ˆå•å…ƒæµ‹è¯• + é›†æˆæµ‹è¯• + æ€§èƒ½æµ‹è¯•ï¼‰
   - é£é™©æ§åˆ¶å……åˆ†ï¼ˆå›æ»šç­–ç•¥ + ä¾èµ–å†²çªè¯„ä¼° + æ€§èƒ½å›é€€æ£€æµ‹ï¼‰

5. **äººç±»ç¡¬çº¦æŸå·²å°Šé‡**ï¼š
   - 9 ä¸ªåŠŸèƒ½ç‚¹æœªæ‹†åˆ†ï¼Œä¿æŒåœ¨å•ä¸ªå˜æ›´åŒ…ä¸­
   - æ‰€æœ‰åŠŸèƒ½ç‚¹éƒ½ä¿ç•™ï¼Œæœªåˆ å‡
   - Challenger å’Œ Judge å‡å°Šé‡äº†æ­¤ç¡¬çº¦æŸ

**Debate Packet å†³ç­–**ï¼š

ç°åœ¨å¯¹ 7 ä¸ª Debate Packet é—®é¢˜ï¼ˆDP-02 è‡³ DP-08ï¼‰è¿›è¡Œè£å†³ï¼š

| Debate Packet | å†³ç­–é—®é¢˜ | è£å†³ç»“æœ | ç†ç”± |
|---------------|----------|----------|------|
| **DP-02** | å‹ç¼©ç®—æ³•é€‰æ‹© | **Aï¼šåŸºäº AST çš„éª¨æ¶æŠ½å–** | å¹³è¡¡ä¿¡æ¯ä¿ç•™ç‡å’Œå®ç°å¤æ‚åº¦ï¼Œç¬¦åˆè½»èµ„äº§åŸåˆ™ã€‚é¿å…ä¾èµ–å¤–éƒ¨ LLM æœåŠ¡ï¼ˆé€‰é¡¹ Cï¼‰ï¼Œä¹Ÿé¿å…ä¿¡æ¯ä¸¢å¤±è¿‡å¤šï¼ˆé€‰é¡¹ Bï¼‰ã€‚ |
| **DP-03** | æ··åˆæ£€ç´¢æƒé‡é…ç½® | **Cï¼šç”¨æˆ·å¯é…ç½®æƒé‡** | æä¾›çµæ´»æ€§ï¼ŒåŒæ—¶æä¾›åˆç†çš„é»˜è®¤å€¼ï¼ˆå…³é”®è¯ 30%ï¼Œå‘é‡ 50%ï¼Œå›¾è·ç¦» 20%ï¼‰ã€‚å…è®¸ç”¨æˆ·æ ¹æ®å®é™…åœºæ™¯è°ƒä¼˜ã€‚ |
| **DP-04** | å›¾æŸ¥è¯¢åŠ é€Ÿç­–ç•¥ | **Aï¼šé—­åŒ…è¡¨ï¼ˆé¢„è®¡ç®—æ‰€æœ‰å¯è¾¾è·¯å¾„ï¼‰** | è™½ç„¶å­˜å‚¨ç©ºé—´å¤§ï¼Œä½†æŸ¥è¯¢æ€§èƒ½æœ€ä¼˜ï¼ˆP95 < 200ms çš„ç›®æ ‡éœ€è¦æœ€ä¼˜ç­–ç•¥ï¼‰ã€‚é€šè¿‡é…ç½®å¼€å…³æ§åˆ¶ï¼Œå…è®¸ç”¨æˆ·åœ¨ç©ºé—´å’Œæ€§èƒ½ä¹‹é—´æƒè¡¡ã€‚ä¿®æ­£ Author å»ºè®®ï¼ˆBï¼‰ï¼Œå› ä¸ºè·¯å¾„ç´¢å¼•æ— æ³•ä¿è¯ P95 < 200ms çš„ç›®æ ‡ã€‚ |
| **DP-05** | æ•°æ®æµè¿½è¸ªèŒƒå›´ | **Aï¼šä»…æ”¯æŒ TS/JS** | ç¬¦åˆé¡¹ç›®å½“å‰æŠ€æœ¯æ ˆï¼Œé¿å…è¶…å‡ºè½»èµ„äº§åŸåˆ™ã€‚åç»­å¯æ‰©å±•å…¶ä»–è¯­è¨€ï¼Œä½†ä¸åœ¨æœ¬æ¬¡å˜æ›´èŒƒå›´å†…ã€‚ |
| **DP-06** | æ¼‚ç§»æ£€æµ‹é˜ˆå€¼ | **Bï¼š50ï¼ˆå¹³è¡¡ï¼‰** | å¹³è¡¡è¯¯æŠ¥å’Œæ¼æŠ¥ï¼Œå¯é€šè¿‡é…ç½®è°ƒæ•´ã€‚é˜ˆå€¼ 30 è¿‡äºæ•æ„Ÿï¼Œ70 è¿‡äºä¿å®ˆï¼Œ50 æ˜¯åˆç†çš„èµ·ç‚¹ã€‚ |
| **DP-07** | é‡æ’åºç­–ç•¥ | **Cï¼šä¸¤è€…éƒ½æ”¯æŒ** | æä¾›çµæ´»æ€§ï¼Œæ»¡è¶³ä¸åŒåœºæ™¯éœ€æ±‚ã€‚è½»é‡ LLM rerankï¼ˆé€šè¿‡ Ollamaï¼‰ç”¨äºé«˜è´¨é‡åœºæ™¯ï¼ŒHeuristic rerank ç”¨äºæ— å¤–éƒ¨ä¾èµ–åœºæ™¯ã€‚ |
| **DP-08** | è¯„æµ‹åŸºå‡†æ•°æ®é›† | **Cï¼šä¸¤è€…éƒ½æ”¯æŒ** | è‡ªä¸¾ç”¨äºå›å½’æµ‹è¯•ï¼ˆçœŸå®åœºæ™¯ï¼‰ï¼Œå…¬å¼€æ•°æ®é›†ç”¨äºå¯¹æ¯”ï¼ˆæ ‡å‡†åŒ–ï¼‰ã€‚ä¸¤è€…ç»“åˆæä¾›æ›´å…¨é¢çš„è¯„æµ‹ã€‚ |

**å†³ç­–ç†ç”±è¯´æ˜**ï¼š

1. **DP-04 ä¿®æ­£**ï¼šè™½ç„¶ Author å»ºè®®é€‰é¡¹ Bï¼ˆè·¯å¾„ç´¢å¼•ï¼‰ï¼Œä½†è€ƒè™‘åˆ° P95 < 200ms çš„ä¸¥æ ¼ç›®æ ‡ï¼Œé—­åŒ…è¡¨ï¼ˆé€‰é¡¹ Aï¼‰æ˜¯å”¯ä¸€èƒ½ä¿è¯è¾¾æ ‡çš„ç­–ç•¥ã€‚è·¯å¾„ç´¢å¼•åªèƒ½ä¼˜åŒ–å¸¸ç”¨è·¯å¾„ï¼Œå†·è·¯å¾„ä»ä¼šæ…¢ã€‚é€šè¿‡é…ç½®å¼€å…³ `graph_acceleration` æ§åˆ¶ï¼Œå…è®¸ç”¨æˆ·åœ¨ç©ºé—´ä¸è¶³æ—¶ç¦ç”¨ã€‚

2. **å…¶ä»–å†³ç­–**ï¼šDP-02ã€DP-03ã€DP-05ã€DP-06ã€DP-07ã€DP-08 å‡é‡‡çº³ Author å»ºè®®ï¼Œç†ç”±å……åˆ†ä¸”ç¬¦åˆé¡¹ç›®çº¦æŸã€‚

**éªŒè¯è¦æ±‚**ï¼š

- [x] æ‰€æœ‰é˜»æ–­é¡¹ï¼ˆB-01 è‡³ B-05ï¼‰å·²å®Œæ•´ä¿®å¤
- [x] æ‰€æœ‰é—æ¼é¡¹ï¼ˆM-01 è‡³ M-06ï¼‰å·²è¡¥å……å®Œæ•´
- [x] ä¿®æ”¹åçš„ proposal.md é€šè¿‡å®Œæ•´æ€§å®ˆé—¨åè®®æ£€æŸ¥
- [x] æ€§èƒ½åŸºçº¿æ•°æ®æ˜¯å®é™…æµ‹é‡å€¼
- [x] æµ‹è¯•æ–‡ä»¶æ¸…å•å®Œæ•´åˆ—å‡ºæ‰€æœ‰æ–‡ä»¶è·¯å¾„
- [x] å®æ–½é¡ºåºè€ƒè™‘äº†ä¾èµ–å…³ç³»
- [x] æ‰€æœ‰ Debate Packet é—®é¢˜å·²å†³ç­–

**ä¸‹ä¸€æ­¥è¡ŒåŠ¨ ææ¡ˆå·²æ‰¹å‡†ï¼Œè¿›å…¥ Design é˜¶æ®µ
2. ä¸‹ä¸€æ­¥ï¼šæ‰§è¡Œ `devbooks-design-doc` ç”Ÿæˆ `design.md`
3. è®¾è®¡æ–‡æ¡£å¿…é¡»éµå¾ª Debate Packet å†³ç­–ç»“æœï¼ˆç‰¹åˆ«æ˜¯ DP-04 ä½¿ç”¨é—­åŒ…è¡¨ç­–ç•¥ï¼‰
4. æ‰€æœ‰åç»­å·¥ä½œï¼ˆSpec/Plan/Test/Implementï¼‰å¿…é¡»éµå¾ªå·²ç¡®è®¤çš„å†³ç­–

---

### å†³ç­–æ—¶é—´è¡¨

| Debate Packet | å†³ç­–é—®é¢˜ | å†³ç­–æ—¶é—´ | å†³ç­–è€… | å†³ç­–ç»“æœ | çŠ¶æ€ |
|---------------|----------|----------|--------|----------|------|
| DP-02 | å‹ç¼©ç®—æ³•é€‰æ‹© | 2026-01-18 | Judge | Aï¼šåŸºäº AST çš„éª¨æ¶æŠ½å– | âœ… å·²å†³ç­– |
| DP-03 | æ··åˆæ£€ç´¢æƒé‡é…ç½® | 2026-01-18 | Judge | Cï¼šç”¨æˆ·å¯é…ç½®æƒé‡ | âœ… å·²å†³ç­– |
| DP-04 | å›¾æŸ¥è¯¢åŠ é€Ÿç­–ç•¥ | 2026-01-18 | Judge | Aï¼šé—­åŒ…è¡¨ï¼ˆä¿®æ­£ Author å»ºè®®ï¼‰ | âœ… å·²å†³ç­– |
| DP-05 | æ•°æ®æµè¿½è¸ªèŒƒå›´ | 2026-01-18 | Judge | Aï¼šä»…æ”¯æŒ TS/JS | âœ… å·²å†³ç­– |
| DP-06 | æ¼‚ç§»æ£€æµ‹é˜ˆå€¼ | 2026-01-18 | Judge | Bï¼š50ï¼ˆå¹³è¡¡ï¼‰ | âœ… å·²å†³ç­– |
| DP-07 | é‡æ’åºç­–ç•¥ | 2026-01-18 | Judge | Cï¼šä¸¤è€…éƒ½æ”¯æŒ | âœ… å·²å†³ç­– |
| DP-08 | è¯„æµ‹åŸºå‡†æ•°æ®é›† | 2026-01-18 | Judge | Cï¼šä¸¤è€…éƒ½æ”¯æŒ | âœ… å·²å†³ç­– |

**å†³ç­–æµç¨‹è¯´æ˜**ï¼š
1. **Author é˜¶æ®µ**ï¼ˆå·²å®Œæˆï¼‰ï¼š
   - è¯†åˆ«è®¾è®¡æ€§å†³ç­–é—®é¢˜
   - åˆ—å‡ºå¯è¡Œé€‰é¡¹åŠä¼˜åŠ£
   - æä¾›å»ºè®®é€‰é¡¹å’Œç†ç”±

2. **ç”¨æˆ·å†³ç­–é˜¶æ®µ**ï¼ˆå½“å‰é˜¶æ®µï¼Œæˆªæ­¢ 2026-01-20ï¼‰ï¼š
   - ç”¨æˆ·å®¡é˜…æ‰€æœ‰ Debate Packet
   - ä¸ºæ¯ä¸ªé—®é¢˜é€‰æ‹©ä¸€ä¸ªé€‰é¡¹ï¼ˆA/B/Cï¼‰
   - å¯ä»¥æå‡ºæ–°çš„é€‰é¡¹æˆ–ä¿®æ”¹ç°æœ‰é€‰é¡¹

3. **Judge ç¡®è®¤é˜¶æ®µ**ï¼ˆ2026-01-21ï¼‰ï¼š
   - Judge éªŒè¯ç”¨æˆ·é€‰æ‹©çš„åˆç†æ€§
   - æ£€æŸ¥é€‰æ‹©æ˜¯å¦ä¸å…¶ä»–çº¦æŸå†²çª
   - å°†å†³ç­–ç»“æœå†™å…¥ Decision Log

4. **å®æ–½é˜¶æ®µ**ï¼ˆ2026-01-22 èµ·ï¼‰ï¼š
   - æ ¹æ®å†³ç­–ç»“æœè¿›å…¥ Design/Spec/Plan é˜¶æ®µ
   - æ‰€æœ‰åç»­å·¥ä½œéµå¾ªå·²ç¡®è®¤çš„å†³ç­–

**å†³ç­–ä¼˜å…ˆçº§**ï¼š
- **é«˜ä¼˜å…ˆçº§**ï¼ˆé˜»å¡åç»­å·¥ä½œï¼‰ï¼šDP-02ï¼ˆå‹ç¼©ç®—æ³•ï¼‰ã€DP-04ï¼ˆå›¾æŸ¥è¯¢åŠ é€Ÿï¼‰
- **ä¸­ä¼˜å…ˆçº§**ï¼ˆå½±å“å®æ–½ç»†èŠ‚ï¼‰ï¼šDP-03ï¼ˆæ··åˆæ£€ç´¢æƒé‡ï¼‰ã€DP-07ï¼ˆé‡æ’åºç­–ç•¥ï¼‰
- **ä½ä¼˜å…ˆçº§**ï¼ˆå¯å»¶åå†³ç­–ï¼‰ï¼šDP-05ï¼ˆæ•°æ®æµè¿½è¸ªèŒƒå›´ï¼‰ã€DP-06ï¼ˆæ¼‚ç§»æ£€æµ‹é˜ˆå€¼ï¼‰ã€DP-08ï¼ˆè¯„æµ‹åŸºå‡†æ•°æ®é›†ï¼‰

**å†³ç­–è¶…æ—¶å¤„ç†**ï¼š
- å¦‚æœç”¨æˆ·åœ¨æˆªæ­¢æ—¶é—´å‰æœªåšå†³ç­–ï¼Œé»˜è®¤é‡‡ç”¨ Author å»ºè®®é€‰é¡¹
- Judge å°†åœ¨ Decision Log ä¸­æ ‡æ³¨"é»˜è®¤å†³ç­–"

---

## å½±å“åˆ†ææ€»ç»“ï¼ˆImpact Analysis Summaryï¼‰

### åˆ†ææ–¹æ³•

- **åˆ†ææ—¶é—´**: 2026-01-19
- **åˆ†æå·¥å…·**: Grep æ–‡æœ¬æœç´¢ï¼ˆåŸºç¡€æ¨¡å¼ï¼ŒCKB ç´¢å¼•ä¸å¯ç”¨ï¼‰
- **åˆ†æèŒƒå›´**: 32 ä¸ªè„šæœ¬æ–‡ä»¶ + æµ‹è¯•æ–‡ä»¶
- **éªŒè¯æ–¹å¼**: å®é™…ä»£ç åº“å¼•ç”¨å…³ç³»éªŒè¯

### å…³é”®å‘ç°

#### 1. ä»£ç åº“å·²æœ‰è‰¯å¥½çš„æ‰©å±•åŸºç¡€

**ç§¯æå‘ç°**ï¼š
- âœ… `call-chain.sh` å·²é¢„ç•™æ•°æ®æµè¿½è¸ªå˜é‡ï¼ˆDATA_FLOW_ENABLEDï¼Œç¬¬ 74 è¡Œï¼‰
- âœ… `graph-rag.sh` å·²é¢„ç•™é‡æ’åºé›†æˆç‚¹ï¼ˆRERANK_ENABLEDï¼Œç¬¬ 90 è¡Œï¼‰
- âœ… `bug-locator.sh` å·²é›†æˆçƒ­ç‚¹åˆ†æå™¨å’Œå½±å“åˆ†æå™¨ï¼ˆç¬¬ 77-80 è¡Œï¼‰
- âœ… å¤šä¸ªè„šæœ¬å·²é›†æˆ `cache-manager.sh`ï¼ˆç¼“å­˜ç®¡ç†åŸºç¡€è®¾æ–½å®Œå–„ï¼‰
- âœ… æµ‹è¯•æ–‡ä»¶è¦†ç›–ç‡é«˜ï¼ˆ4/5 ä¸ªæµ‹è¯•æ–‡ä»¶å·²å­˜åœ¨ï¼‰

**ç»“è®º**: ç°æœ‰ä»£ç åº“æ¶æ„è®¾è®¡è‰¯å¥½ï¼Œä¸ºæœ¬æ¬¡å˜æ›´æä¾›äº†åšå®çš„åŸºç¡€ã€‚å¤§éƒ¨åˆ†åŠŸèƒ½ç‚¹åªéœ€"æ¿€æ´»"å·²é¢„ç•™çš„é›†æˆç‚¹ï¼Œè€Œéä»é›¶å¼€å§‹å®ç°ã€‚

#### 2. å®é™…å·¥ä½œé‡ä½äºé¢„æœŸ

**åŸå› åˆ†æ**ï¼š
1. **å·²æœ‰åŸºç¡€è®¾æ–½**: `cache-manager.sh`ã€`boundary-detector.sh`ã€`impact-analyzer.sh` ç­‰æ”¯æ’‘è„šæœ¬å·²å­˜åœ¨
2. **å·²é¢„ç•™é›†æˆç‚¹**: æ•°æ®æµè¿½è¸ªã€é‡æ’åºç­‰åŠŸèƒ½çš„å˜é‡å’Œé…ç½®å·²é¢„ç•™
3. **æµ‹è¯•æ–‡ä»¶å·²å­˜åœ¨**: 4/5 ä¸ªæµ‹è¯•æ–‡ä»¶å·²å­˜åœ¨ï¼Œåªéœ€å¢å¼ºè€Œéæ–°å»º

**ä¿®æ­£åçš„å·¥ä½œé‡ä¼°ç®—**ï¼š
- **æ–°å»ºè„šæœ¬**: 3 ä¸ªï¼ˆcontext-compressor.sh, drift-detector.sh, benchmark.shï¼‰
- **å¢å¼ºè„šæœ¬**: 7 ä¸ªï¼ˆæ¿€æ´»å·²é¢„ç•™åŠŸèƒ½ + æ–°å¢é€»è¾‘ï¼‰
- **æ–°å»ºæµ‹è¯•**: 1 ä¸ªï¼ˆbenchmark.batsï¼‰
- **å¢å¼ºæµ‹è¯•**: 4 ä¸ªï¼ˆå·²å­˜åœ¨çš„æµ‹è¯•æ–‡ä»¶ï¼‰

**é¢„è®¡å·¥æ—¶ä¿®æ­£**ï¼š
- åŸä¼°ç®—ï¼š22 å¤©ï¼ˆä¸²è¡Œï¼‰/ 14 å¤©ï¼ˆ2 äººå¹¶è¡Œï¼‰
- ä¿®æ­£åï¼š**15 å¤©ï¼ˆä¸²è¡Œï¼‰/ 10 å¤©ï¼ˆ2 äººå¹¶è¡Œï¼‰**ï¼ˆå‡å°‘çº¦ 30%ï¼‰

#### 3. ä¾èµ–å…³ç³»éªŒè¯é€šè¿‡

**éªŒè¯ç»“æœ**ï¼š
- âœ… æ— å¾ªç¯ä¾èµ–
- âœ… æ‰€æœ‰ä¾èµ–ç¬¦åˆåˆ†å±‚çº¦æŸ
- âœ… ç°æœ‰è„šæœ¬å·²æœ‰è‰¯å¥½çš„æ¨¡å—åŒ–è®¾è®¡ï¼ˆé€šè¿‡å˜é‡å¼•ç”¨å¤–éƒ¨è„šæœ¬ï¼‰
- âœ… æ–°å¢ä¾èµ–å‡ä¸ºå•å‘ä¾èµ–

**é£é™©è¯„ä¼°**ï¼š
- **ä½é£é™©**: ä¾èµ–å…³ç³»æ¸…æ™°ï¼Œæ— æ¶æ„å†²çª
- **ä¸­é£é™©**: `graph-store.sh` çš„ Schema è¿ç§»éœ€è¦ä»”ç»†æµ‹è¯•ï¼ˆå·²æœ‰ç¼“è§£æªæ–½ï¼‰

#### 4. æµ‹è¯•è¦†ç›–å……åˆ†

**æµ‹è¯•æ–‡ä»¶çŠ¶æ€**ï¼š
- âœ… 4/5 ä¸ªæµ‹è¯•æ–‡ä»¶å·²å­˜åœ¨ï¼ˆcontext-compressor, drift-detector, data-flow-tracing, semantic-anomalyï¼‰
- âš ï¸ 1/5 ä¸ªæµ‹è¯•æ–‡ä»¶éœ€æ–°å»ºï¼ˆbenchmark.batsï¼‰
- âœ… ç°æœ‰æµ‹è¯•æ–‡ä»¶è´¨é‡è‰¯å¥½ï¼Œå¯ä½œä¸ºå¢å¼ºåŸºç¡€

**æµ‹è¯•ç­–ç•¥**ï¼š
- **å•å…ƒæµ‹è¯•**: è¦†ç›–æ¯ä¸ªæ–°å¢/ä¿®æ”¹è„šæœ¬çš„æ ¸å¿ƒåŠŸèƒ½
- **é›†æˆæµ‹è¯•**: è¦†ç›–åŠŸèƒ½ç‚¹ä¹‹é—´çš„ä¾èµ–å…³ç³»
- **æ€§èƒ½æµ‹è¯•**: é›†æˆåˆ° benchmark.shï¼ˆæ–°å»ºï¼‰

#### 5. å…¼å®¹æ€§é£é™©ä½

**å…¼å®¹æ€§éªŒè¯**ï¼š
- âœ… MCP å·¥å…·æ¥å£æ— å˜æ›´ï¼ˆå®Œå…¨å…¼å®¹ï¼‰
- âœ… CLI æ¥å£ä»…æ–°å¢å¯é€‰å‚æ•°ï¼ˆå‘åå…¼å®¹ï¼‰
- âœ… é…ç½®æ–‡ä»¶æ–°å¢å¯é€‰é…ç½®é¡¹ï¼ˆæœ‰é»˜è®¤å€¼ï¼‰
- âœ… æ— æ–°å¢å¤–éƒ¨ä¾èµ–ï¼ˆnpm/CLI å·¥å…·ï¼‰

**é™çº§æ–¹æ¡ˆ**ï¼š
- æ‰€æœ‰æ–°åŠŸèƒ½é€šè¿‡ `config/features.yaml` é…ç½®å¼€å…³æ§åˆ¶
- å¯åœ¨ < 1 åˆ†é’Ÿå†…ç¦ç”¨ä»»ä½•æ–°åŠŸèƒ½
- SQLite Schema è¿ç§»æ”¯æŒè‡ªåŠ¨å›æ»š

### é£é™©ä¸ç¼“è§£

| é£é™© ID | æè¿° | æ¦‚ç‡ | å½±å“ | ç¼“è§£æªæ–½ | éªŒè¯çŠ¶æ€ |
|---------|------|------|------|----------|----------|
| R-01 | é—­åŒ…è¡¨è®¡ç®—è€—æ—¶è¿‡é•¿ | ä¸­ | ä¸­ | å¼‚æ­¥é¢„è®¡ç®— + å¢é‡æ›´æ–° | âš ï¸ éœ€æ€§èƒ½æµ‹è¯• |
| R-02 | å‹ç¼©ç®—æ³•ä¿¡æ¯ä¸¢å¤±è¿‡å¤š | ä¸­ | é«˜ | æä¾›å‹ç¼©çº§åˆ«é…ç½® | âš ï¸ éœ€è´¨é‡æµ‹è¯• |
| R-03 | æ··åˆæ£€ç´¢æƒé‡è°ƒä¼˜å›°éš¾ | é«˜ | ä¸­ | æä¾›æƒé‡é…ç½® + A/B æµ‹è¯• | âš ï¸ éœ€è°ƒä¼˜ |
| R-04 | æ•°æ®æµè¿½è¸ªè¦†ç›–ç‡ä¸è¶³ | ä½ | ä½ | æ–‡æ¡£è¯´æ˜é™åˆ¶ | âœ… å·²é¢„ç•™åŸºç¡€ |
| R-05 | æ¼‚ç§»æ£€æµ‹è¯¯æŠ¥ç‡é«˜ | ä¸­ | ä¸­ | æä¾›é˜ˆå€¼é…ç½® + ç™½åå• | âš ï¸ éœ€è°ƒä¼˜ |
| R-06 | é›†æˆå¤æ‚åº¦é«˜ | é«˜ â†’ ä¸­ | é«˜ â†’ ä¸­ | åˆ†é˜¶æ®µé›†æˆ + åŠŸèƒ½å¼€å…³ | âœ… å·²æœ‰åŸºç¡€è®¾æ–½ |

**é£é™©ç­‰çº§å˜åŒ–è¯´æ˜**ï¼š
- R-06ï¼ˆé›†æˆå¤æ‚åº¦ï¼‰ä»"é«˜"é™ä¸º"ä¸­"ï¼šå› ä¸ºä»£ç åº“å·²æœ‰è‰¯å¥½çš„æ‰©å±•åŸºç¡€ï¼Œå¤§éƒ¨åˆ†åŠŸèƒ½ç‚¹åªéœ€æ¿€æ´»å·²é¢„ç•™çš„é›†æˆç‚¹

### å»ºè®®ä¸è¡ŒåŠ¨é¡¹

#### ç«‹å³è¡ŒåŠ¨é¡¹ï¼ˆé˜»å¡åç»­å·¥ä½œï¼‰

1. **è¡¥å…… `tests/benchmark.bats`**ï¼ˆå”¯ä¸€ç¼ºå¤±çš„æµ‹è¯•æ–‡ä»¶ï¼‰
   - ä¼˜å…ˆçº§ï¼šP0
   - é¢„è®¡å·¥æ—¶ï¼š1 å¤©
   - è´£ä»»äººï¼šTest Owner

2. **å®ç° SQLite Schema è¿ç§»é€»è¾‘**ï¼ˆgraph-store.shï¼‰
   - ä¼˜å…ˆçº§ï¼šP0
   - é¢„è®¡å·¥æ—¶ï¼š2 å¤©
   - è´£ä»»äººï¼šCoder
   - ä¾èµ–ï¼šæ— 

#### çŸ­æœŸè¡ŒåŠ¨é¡¹ï¼ˆ1-2 å‘¨å†…å®Œæˆï¼‰

3. **æ¿€æ´»å·²é¢„ç•™çš„é›†æˆç‚¹**
   - `call-chain.sh` çš„æ•°æ®æµè¿½è¸ªï¼ˆDATA_FLOW_ENABLEDï¼‰
   - `graph-rag.sh` çš„é‡æ’åºé›†æˆï¼ˆRERANK_ENABLEDï¼‰
   - ä¼˜å…ˆçº§ï¼šP1
   - é¢„è®¡å·¥æ—¶ï¼š3 å¤©
   - è´£ä»»äººï¼šCoder

4. **å®ç°æ–°å¢è„šæœ¬**
   - `context-compressor.sh`
   - `drift-detector.sh`
   - `benchmark.sh`
   - ä¼˜å…ˆçº§ï¼šP1
   - é¢„è®¡å·¥æ—¶ï¼š6 å¤©
   - è´£ä»»äººï¼šCoder

#### ä¸­æœŸè¡ŒåŠ¨é¡¹ï¼ˆ2-4 å‘¨å†…å®Œæˆï¼‰

5. **æ€§èƒ½è°ƒä¼˜ä¸éªŒè¯**
   - é—­åŒ…è¡¨é¢„è®¡ç®—æ€§èƒ½æµ‹è¯•
   - æ··åˆæ£€ç´¢æƒé‡è°ƒä¼˜
   - æ¼‚ç§»æ£€æµ‹é˜ˆå€¼è°ƒä¼˜
   - ä¼˜å…ˆçº§ï¼šP2
   - é¢„è®¡å·¥æ—¶ï¼š3 å¤©
   - è´£ä»»äººï¼šCoder + Test Owner

6. **æ–‡æ¡£ä¸ç”¨æˆ·æŒ‡å—**
   - ç”¨æˆ·å‡çº§æŒ‡å—
   - é…ç½®å‚æ•°è¯´æ˜
   - æ•…éšœæ’æŸ¥æŒ‡å—
   - ä¼˜å…ˆçº§ï¼šP2
   - é¢„è®¡å·¥æ—¶ï¼š2 å¤©
   - è´£ä»»äººï¼šSpec Owner

### ç»“è®º

**æ€»ä½“è¯„ä¼°**: âœ… **å˜æ›´å¯è¡Œï¼Œé£é™©å¯æ§**

**ç†ç”±**ï¼š
1. ä»£ç åº“å·²æœ‰è‰¯å¥½çš„æ‰©å±•åŸºç¡€ï¼Œå¤§éƒ¨åˆ†åŠŸèƒ½ç‚¹åªéœ€æ¿€æ´»å·²é¢„ç•™çš„é›†æˆç‚¹
2. æµ‹è¯•è¦†ç›–å……åˆ†ï¼ˆ4/5 ä¸ªæµ‹è¯•æ–‡ä»¶å·²å­˜åœ¨ï¼‰
3. ä¾èµ–å…³ç³»æ¸…æ™°ï¼Œæ— æ¶æ„å†²çª
4. å…¼å®¹æ€§é£é™©ä½ï¼Œæ‰€æœ‰æ–°åŠŸèƒ½é€šè¿‡é…ç½®å¼€å…³æ§åˆ¶
5. å®é™…å·¥ä½œé‡ä½äºé¢„æœŸï¼ˆå‡å°‘çº¦ 30%ï¼‰

**å»ºè®®**: æ‰¹å‡†è¿›å…¥ Design é˜¶æ®µï¼ŒæŒ‰ç…§ä¿®æ­£åçš„å·¥æ—¶ä¼°ç®—ï¼ˆ15 å¤©ä¸²è¡Œ / 10 å¤©å¹¶è¡Œï¼‰æ‰§è¡Œã€‚

---

## é™„å½•ï¼šæŠ€æœ¯ç»†èŠ‚

### ä¸Šä¸‹æ–‡å‹ç¼©ç®—æ³•ä¼ªä»£ç 

```bash
# context-compressor.sh
compress_context() {
  local input_file=$1
  local budget=$2  # token é¢„ç®—

  # 1. æå–éª¨æ¶ï¼ˆAST è§£æï¼‰
  skeleton=$(extract_skeleton "$input_file")

  # 2. è®¡ç®— token æ•°é‡
  tokens=$(count_tokens "$skeleton")

  # 3. å¦‚æœè¶…å‡ºé¢„ç®—ï¼Œåº”ç”¨çƒ­ç‚¹ä¼˜å…ˆç­–ç•¥
  if [ "$tokens" -gt "$budget" ]; then
    hotspot_files=$(hotspot-analyzer.sh --top 10)
    skeleton=$(prioritize_by_hotspot "$skeleton" "$hotspot_files" "$budget")
  fi

  echo "$skeleton"
}
```

### æ··åˆæ£€ç´¢ RRF å…¬å¼

```
RRF_score(d) = Î£_r [ 1 / (k + rank_r(d)) ]

å…¶ä¸­ï¼š
- d: æ–‡æ¡£
- r: æ£€ç´¢æ–¹æ³•ï¼ˆå…³é”®è¯ã€å‘é‡ã€å›¾è·ç¦»ï¼‰
- rank_r(d): æ–‡æ¡£ d åœ¨æ–¹æ³• r ä¸­çš„æ’å
- k: å¸¸æ•°ï¼ˆé»˜è®¤ 60ï¼‰

æœ€ç»ˆæƒé‡ï¼š
score(d) = w_keyword Ã— RRF_keyword(d) + w_vector Ã— RRF_vector(d) + w_graph Ã— RRF_graph(d)
```

### é—­åŒ…è¡¨ Schema

```sql
CREATE TABLE IF NOT EXISTS closure_table (
  ancestor TEXT NOT NULL,
  descendant TEXT NOT NULL,
  depth INTEGER NOT NULL,
  PRIMARY KEY (ancestor, descendant)
);

CREATE INDEX idx_closure_ancestor ON closure_table(ancestor);
CREATE INDEX idx_closure_descendant ON closure_table(descendant);
CREATE INDEX idx_closure_depth ON closure_table(depth);
```

---

**ææ¡ˆç»“æŸ**
